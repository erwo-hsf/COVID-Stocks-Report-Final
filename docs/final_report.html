<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eric Wolff, Mats Biermann, Laurine Fleck">

<title>How do Technology, Tourism, Pharmaceutical, and Energy stocks differ in volatility and recovery during and after the COVID-19 pandemic?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="final_report_web_files/libs/clipboard/clipboard.min.js"></script>
<script src="final_report_web_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="final_report_web_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="final_report_web_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="final_report_web_files/libs/quarto-html/popper.min.js"></script>
<script src="final_report_web_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final_report_web_files/libs/quarto-html/anchor.min.js"></script>
<link href="final_report_web_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final_report_web_files/libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final_report_web_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final_report_web_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final_report_web_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">How do Technology, Tourism, Pharmaceutical, and Energy stocks differ in volatility and recovery during and after the COVID-19 pandemic?</h1>
            <p class="subtitle lead">Data Science and Data Analytics</p>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Eric Wolff, Mats Biermann, Laurine Fleck </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-ew-lf-mb" id="toc-introduction-ew-lf-mb" class="nav-link active" data-scroll-target="#introduction-ew-lf-mb"><span class="header-section-number">1</span> Introduction (EW, LF, MB)</a></li>
  <li><a href="#theoretical-background-lf" id="toc-theoretical-background-lf" class="nav-link" data-scroll-target="#theoretical-background-lf"><span class="header-section-number">2</span> Theoretical Background (LF)</a>
  <ul class="collapse">
  <li><a href="#definition-of-financial-market-behvaior-from-2019-to-2023-mb" id="toc-definition-of-financial-market-behvaior-from-2019-to-2023-mb" class="nav-link" data-scroll-target="#definition-of-financial-market-behvaior-from-2019-to-2023-mb"><span class="header-section-number">2.1</span> Definition of Financial Market behvaior from 2019 to 2023 (MB)</a></li>
  <li><a href="#definition-volatility-and-recovery-dynamics-lf" id="toc-definition-volatility-and-recovery-dynamics-lf" class="nav-link" data-scroll-target="#definition-volatility-and-recovery-dynamics-lf"><span class="header-section-number">2.2</span> Definition Volatility and Recovery Dynamics (LF)</a></li>
  <li><a href="#definition-of-covid-19-pandemic-ew" id="toc-definition-of-covid-19-pandemic-ew" class="nav-link" data-scroll-target="#definition-of-covid-19-pandemic-ew"><span class="header-section-number">2.3</span> Definition of COVID-19 Pandemic (EW)</a></li>
  <li><a href="#overviews-of-stock-markets-ew-lf-mb" id="toc-overviews-of-stock-markets-ew-lf-mb" class="nav-link" data-scroll-target="#overviews-of-stock-markets-ew-lf-mb"><span class="header-section-number">2.4</span> Overviews of Stock Markets (EW, LF, MB)</a>
  <ul class="collapse">
  <li><a href="#lufthansa-brand-and-stock-overview-mb" id="toc-lufthansa-brand-and-stock-overview-mb" class="nav-link" data-scroll-target="#lufthansa-brand-and-stock-overview-mb"><span class="header-section-number">2.4.1</span> Lufthansa Brand and Stock Overview (MB)</a></li>
  <li><a href="#shell-brand-and-stock-overview-ew" id="toc-shell-brand-and-stock-overview-ew" class="nav-link" data-scroll-target="#shell-brand-and-stock-overview-ew"><span class="header-section-number">2.4.2</span> Shell: Brand and Stock Overview (EW)</a></li>
  <li><a href="#apple-brand-and-stock-overview-lf" id="toc-apple-brand-and-stock-overview-lf" class="nav-link" data-scroll-target="#apple-brand-and-stock-overview-lf"><span class="header-section-number">2.4.3</span> Apple: BRand and Stock Overview (LF)</a></li>
  <li><a href="#biontech-brand-and-stock-overview-lf" id="toc-biontech-brand-and-stock-overview-lf" class="nav-link" data-scroll-target="#biontech-brand-and-stock-overview-lf"><span class="header-section-number">2.4.4</span> BioNTech: Brand and Stock Overview (LF)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#methodology-ew" id="toc-methodology-ew" class="nav-link" data-scroll-target="#methodology-ew"><span class="header-section-number">3</span> Methodology (EW)</a>
  <ul class="collapse">
  <li><a href="#stock-data-extraction-and-cleaning-ew" id="toc-stock-data-extraction-and-cleaning-ew" class="nav-link" data-scroll-target="#stock-data-extraction-and-cleaning-ew"><span class="header-section-number">3.1</span> Stock Data Extraction and Cleaning (EW)</a></li>
  <li><a href="#covid-dataset-extraction-cleaning-and-visualization-ew" id="toc-covid-dataset-extraction-cleaning-and-visualization-ew" class="nav-link" data-scroll-target="#covid-dataset-extraction-cleaning-and-visualization-ew"><span class="header-section-number">3.2</span> COVID Dataset Extraction, Cleaning and Visualization (EW)</a></li>
  <li><a href="#descriptive-analysis-lf" id="toc-descriptive-analysis-lf" class="nav-link" data-scroll-target="#descriptive-analysis-lf"><span class="header-section-number">3.3</span> Descriptive Analysis (LF)</a></li>
  <li><a href="#predictive-analysis-mb" id="toc-predictive-analysis-mb" class="nav-link" data-scroll-target="#predictive-analysis-mb"><span class="header-section-number">3.4</span> Predictive Analysis (MB)</a></li>
  <li><a href="#granger-causality-analysis-mb" id="toc-granger-causality-analysis-mb" class="nav-link" data-scroll-target="#granger-causality-analysis-mb"><span class="header-section-number">3.5</span> Granger Causality Analysis (MB)</a>
  <ul class="collapse">
  <li><a href="#stationarity-test-mb" id="toc-stationarity-test-mb" class="nav-link" data-scroll-target="#stationarity-test-mb"><span class="header-section-number">3.5.1</span> Stationarity Test (MB)</a></li>
  <li><a href="#time-series-become-stationary-mb" id="toc-time-series-become-stationary-mb" class="nav-link" data-scroll-target="#time-series-become-stationary-mb"><span class="header-section-number">3.5.2</span> Time Series Become Stationary (MB)</a></li>
  <li><a href="#conducting-cranger-causality-test-mb" id="toc-conducting-cranger-causality-test-mb" class="nav-link" data-scroll-target="#conducting-cranger-causality-test-mb"><span class="header-section-number">3.5.3</span> Conducting Cranger Causality Test (MB)</a></li>
  </ul></li>
  <li><a href="#regression-analysis-ew" id="toc-regression-analysis-ew" class="nav-link" data-scroll-target="#regression-analysis-ew"><span class="header-section-number">3.6</span> Regression Analysis (EW)</a></li>
  </ul></li>
  <li><a href="#conclusion-ew.-lf-mb" id="toc-conclusion-ew.-lf-mb" class="nav-link" data-scroll-target="#conclusion-ew.-lf-mb"><span class="header-section-number">4</span> Conclusion (EW. LF, MB)</a></li>
  <li><a href="#statement-ew-lf-mb" id="toc-statement-ew-lf-mb" class="nav-link" data-scroll-target="#statement-ew-lf-mb"><span class="header-section-number">5</span> Statement (EW, LF, MB)</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#affidavit" id="toc-affidavit" class="nav-link" data-scroll-target="#affidavit"><span class="header-section-number">6</span> Affidavit</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction-ew-lf-mb" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction (EW, LF, MB)</h1>
<p>“March 2020 saw one of the most dramatic stock market crashes in history” (<span class="citation" data-cites="MazurEtAl2021">Mazur, Dang, and Vega (<a href="#ref-MazurEtAl2021" role="doc-biblioref">2021</a>)</span>). The quote highlights COVID as a significant event that not only had health consequences but also immense economic consequences worldwide. A crisis, which can influence people’s psychology, as well as financial decision making, is one of a kind (<span class="citation" data-cites="AryaSingh2025">Arya and Singh (<a href="#ref-AryaSingh2025" role="doc-biblioref">2025</a>)</span>). To determine the extent to which the COVID-19 pandemic affected the financial market, we selected four different industries to compare, including one stock for the technology, tourism, pharmaceutical, and energy sector. For each industry, we chose a well-known company, to represent each sector. Apple is provided for the technology, Shell for energy, Lufthansa for tourism, and BioNtech for the pharmaceutical industry (<span class="citation" data-cites="Noor2021">Noor (<a href="#ref-Noor2021" role="doc-biblioref">2021</a>)</span>). Especially BioNtech is chosen, due to its invention of a vaccine influencing humanity during COVID making it interesting for later analysis. We concentrated on these four industries due to studies that found out that industries included in our project have been hit differently by the pandemic. These influences can be extremely postive but also negatively impact the different sectors (<span class="citation" data-cites="MazurEtAl2021">Mazur, Dang, and Vega (<a href="#ref-MazurEtAl2021" role="doc-biblioref">2021</a>)</span>). Therefore, it is reasonable to examine which of our chosen sectors represented by the stock have been particularly affected by the pandemic between 2019 and 2023. This period of time shows how the stock’s prices behaved before, during and after the pandemic.</p>
<p>To make COVID’s impact measurable, we focus on two factors. On the one hand, volatility serving as an indicator of risk and uncertainty (<span class="citation" data-cites="Rustamov2024">Rustamov (<a href="#ref-Rustamov2024" role="doc-biblioref">2024</a>)</span>; <span class="citation" data-cites="Nicolay2011">Nicolay (<a href="#ref-Nicolay2011" role="doc-biblioref">2011</a>)</span>), while on the other hand, recovery dynamics to measure the pandemic’s sustainable influence on the stock’s performance and if there is a return to the stock’s pre-COVID level will be examined (<span class="citation" data-cites="BuiEtAl2024">Bui et al. (<a href="#ref-BuiEtAl2024" role="doc-biblioref">2024</a>)</span>; <span class="citation" data-cites="BuijsEtAl2025">Buijs et al. (<a href="#ref-BuijsEtAl2025" role="doc-biblioref">2025</a>)</span>). Therefore, the goal of this paper is to answer the following question: “To what extend do technology, toursim, pharmaceutical, and energy stocks differ in terms of their price volatility and recovery dynamics during and after the COVID-19 pandemic?”</p>
</section>
<section id="theoretical-background-lf" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Theoretical Background (LF)</h1>
<p>For developing a general understanding of our research, this chapter will first explain what financial market behavior is and how it can be represented in the period from 2019 to 2023. To ensure that our codes and their analysis at the end can be easily followed later, we will clarify what volatility is and when it will be used. We will also outline what recovery dynamics are. Since our research question spans the entire duration of the Covid-19 pandemic, we make sure to provide a detailed explanation of what the Covid-19 and the associated pandemic entail.</p>
<section id="definition-of-financial-market-behvaior-from-2019-to-2023-mb" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="definition-of-financial-market-behvaior-from-2019-to-2023-mb"><span class="header-section-number">2.1</span> Definition of Financial Market behvaior from 2019 to 2023 (MB)</h2>
<p>Between 2019 and 2023, the behavior of the financial markets was shaped by various macroeconomic developments, influenced by global crises and monetary policy changes. During this period, behavioral finance and investment have proven to be very relevant research topics, as they were extremely affected. This time, particularly the so-called Efficient Market Hypothesis, which had been in place until then, was briefly described as the EMH. This HMH hypothesis assumes that markets and investors act rationally. However, this was refuted by observations such as market anomalies like price overruns (<span class="citation" data-cites="AryaSingh2025">Arya and Singh (<a href="#ref-AryaSingh2025" role="doc-biblioref">2025</a>)</span>).</p>
<p>The COVID-19 pandemic and the Ukraine conflict caused significant economic uncertainty. These events, which could be described as rather unforeseen, had a long-term impact on economic growth in all countries worldwide and the stability of financial markets (<span class="citation" data-cites="Bundesbank2023">Deutsche Bundesbank (<a href="#ref-Bundesbank2023" role="doc-biblioref">2023</a>)</span>). For instance, in Germany, a fundamental change in the financial system took place during this period, especially as the European Central Bank, ECB, adjusted interest rates quickly and significantly in response to increasing inflation (<span class="citation" data-cites="Bundesbank2023">Deutsche Bundesbank (<a href="#ref-Bundesbank2023" role="doc-biblioref">2023</a>)</span>). This measure had an immediate impact on both households and businesses. Due to the increasing measures in interest rates, there was also an increase in credit risks (<span class="citation" data-cites="ECB2023">European Central Bank (<a href="#ref-ECB2023" role="doc-biblioref">2023</a>)</span>).</p>
<p>The behavior of international markets during the period from 2019 to 2023 was marked by signs of irrational decisions. Often attributed to psychological factors such as overconfidence and herd behavior. Overconfidence led investors to overestimate their knowledge and abilities, resulting in excessive trading and an increase in volatility (<span class="citation" data-cites="AryaSingh2025">Arya and Singh (<a href="#ref-AryaSingh2025" role="doc-biblioref">2025</a>)</span>). Additionally, in time of a crisis, herd behavior contributes to amplification of market movements, thus clearly demonstrates the inefficiency of financials markets (<span class="citation" data-cites="AryaSingh2025">Arya and Singh (<a href="#ref-AryaSingh2025" role="doc-biblioref">2025</a>)</span>). The new regulatory adjustments made during the pandemic also contributed to the stability of the financial systems (<span class="citation" data-cites="Bundesbank2023">Deutsche Bundesbank (<a href="#ref-Bundesbank2023" role="doc-biblioref">2023</a>)</span>). It became increasingly clear that psychological factors had to be included in market analysis, as they often led to deviations from traditional models. Both the war and the pandemic clearly influenced the investment behavior of individuals and companies (<span class="citation" data-cites="AryaSingh2025">Arya and Singh (<a href="#ref-AryaSingh2025" role="doc-biblioref">2025</a>)</span>; <span class="citation" data-cites="Bundesbank2023">Deutsche Bundesbank (<a href="#ref-Bundesbank2023" role="doc-biblioref">2023</a>)</span>).</p>
<p>In summary, the behavior of the financial markets between 2019 and 2023 reflects the interplay between economic theories and psychological influences. It became crucial that the understanding of most people has been distorted, which is often due to emotional influences. That’s the only way to explain the complexity of the markets during this time and the effective risk mitigation strategies that were implemented (<span class="citation" data-cites="AryaSingh2025">Arya and Singh (<a href="#ref-AryaSingh2025" role="doc-biblioref">2025</a>)</span>).</p>
</section>
<section id="definition-volatility-and-recovery-dynamics-lf" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="definition-volatility-and-recovery-dynamics-lf"><span class="header-section-number">2.2</span> Definition Volatility and Recovery Dynamics (LF)</h2>
<p>Price fluctuations over a certain period of time are referred to as volatility in the financial markets. It serves as an indicator of risk and uncertainty and significantly influences investor behavior and market dynamics. These fluctuations influence and are decisive for risk management and the so-called identification of investment opportunities. The standard deviation of returns, which qualifies the distribution of prices around their mean, is typically used to measure volatility (<span class="citation" data-cites="Rustamov2024">Rustamov (<a href="#ref-Rustamov2024" role="doc-biblioref">2024</a>)</span>; <span class="citation" data-cites="Nicolay2011">Nicolay (<a href="#ref-Nicolay2011" role="doc-biblioref">2011</a>)</span>).</p>
<p>Volatility has gained importance in recent years, triggered by economic uncertainty and technological change. Nowadays, market participants need an in-depth understanding of volatility to fully comprehend the complexity of the financial landscape as best they can (<span class="citation" data-cites="Rustamov2024">Rustamov (<a href="#ref-Rustamov2024" role="doc-biblioref">2024</a>)</span>). Several methods are available to measure volatility. The first is historical volatility, which is based on actual price movements, and the latter is implied volatility, which is derived from option prices (<span class="citation" data-cites="Guagliano2018">Guagliano (<a href="#ref-Guagliano2018" role="doc-biblioref">2018</a>)</span>). Volatility is not only a statistical measure but also a significant indicator of market psychology and investor behavior. An example of it would be decision making in financial markets, where the dynamics of volatility, including volatility concentration, play a decisive role (<span class="citation" data-cites="Rustamov2024">Rustamov (<a href="#ref-Rustamov2024" role="doc-biblioref">2024</a>)</span>; <span class="citation" data-cites="Nicolay2011">Nicolay (<a href="#ref-Nicolay2011" role="doc-biblioref">2011</a>)</span>).</p>
<p>Recovery dynamics refer to the ability of financial networks to stabilize after a financial shock or crisis and resume their normal activities. These dynamics play a special role, because if they fail, there could be a kind of chain reaction for individual institutions. This can cause extreme crises that can affect the entire financial sector. The stabilization of a network depends on various factors, for example, the structure of the network, the internal dynamics, and the mechanisms that are used in case of malfunctions. To reduce systemic risks and ensure the stability of the entire system, a strong network structure is essential (<span class="citation" data-cites="BuiEtAl2024">Bui et al. (<a href="#ref-BuiEtAl2024" role="doc-biblioref">2024</a>)</span>; <span class="citation" data-cites="BuijsEtAl2025">Buijs et al. (<a href="#ref-BuijsEtAl2025" role="doc-biblioref">2025</a>)</span>).</p>
<p>Understanding the relationship between financial institutions is vital for assessing recovery. There are often connections between these networks, which basically means that the failure of one organization could affect another relatively quickly. Recovery capacity is promoted through various measures, including capital buffers, stress tests, and relevant regulatory frameworks (<span class="citation" data-cites="BuiEtAl2024">Bui et al. (<a href="#ref-BuiEtAl2024" role="doc-biblioref">2024</a>)</span>; <span class="citation" data-cites="BuijsEtAl2025">Buijs et al. (<a href="#ref-BuijsEtAl2025" role="doc-biblioref">2025</a>)</span>).</p>
<p>In summary, volatility and recovery dynamics are fundamental concepts for the accurate assessment and related management of stability of financial markets. Volatility can thus be described as a kind of measuring device for potential risks and uncertainties. Meanwhile, recovery dynamics rather show the ability of stabilization and regulate financial systems.</p>
</section>
<section id="definition-of-covid-19-pandemic-ew" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="definition-of-covid-19-pandemic-ew"><span class="header-section-number">2.3</span> Definition of COVID-19 Pandemic (EW)</h2>
<p>By the end of 2019, the COVID-19 pandemic, caused by the SARS-CoV-2 virus, presented one of the greatest global challenges. The virus, first discovered in Wuhan, China, quickly spread globally and led humanity into an unprecedented crisis. The World Health Organization, known as the WHO, officially named the disease on February 11, 2020 Coronavirus Disease 2019 COVID-19.</p>
<p>Coronaviruses, a family of viruses, can cause mild to severe illness. SARS-CoV-2 was known at the time as highly contagious and spread quickly. The incubation period varies between 0 and 14 days, which made it hard to contain the pandemic (<span class="citation" data-cites="SouzaEtAl2021">Souza et al. (<a href="#ref-SouzaEtAl2021" role="doc-biblioref">2021</a>)</span>). The pandemic had far-reaching consequences that affected nearly all aspects of human life. Of course, the healthcare systems were put to the test, which presented a major challenge for many hospitals. Accordingly, there was a shortage of medical equipment and personal. This overload led to a critical situation in which the medical staff reached its limits. The health burdens were not only physical but also affected the metal health of the population, as they suffered a lot from the strict measures to contain the virus. Lockdowns, as well as quarantines, contributed to a significant increase in anxiety, depression, and other mental health issues (<span class="citation" data-cites="NaveedEtAl2024">Naveed et al. (<a href="#ref-NaveedEtAl2024" role="doc-biblioref">2024</a>)</span>).</p>
<p>The pandemic had several economic consequences, especially in the so-called emerging markets, where numerous sectors had to report enormous losses. Due to travel restrictions and lockdowns, tourism, aviation, and the hospitality industry, which are crucial for many economies, were particularly affected. As a result of the pandemic, the gross domestic product (GDP) in countries like Spain and Italy also fell. This led to high unemployment and a wave of poverty. Worldwide, the circumstances that had never occurred before led to a global increase in inequality and economic uncertainty (<span class="citation" data-cites="NaveedEtAl2024">Naveed et al. (<a href="#ref-NaveedEtAl2024" role="doc-biblioref">2024</a>)</span>).</p>
<p>Education was an area that was particularly affected. The closure of schools and universities had a profound impact on more than 1.5 billion students. The shift to online learning was a major challenge, as many students lacked access to the necessary technology, leading to an increase in demand for technological devices. The lack of human contact had a crucial impact on students’ psyche, including loss of motivation regarding studying and increased stress and anxiety (<span class="citation" data-cites="NaveedEtAl2024">Naveed et al. (<a href="#ref-NaveedEtAl2024" role="doc-biblioref">2024</a>)</span>).</p>
<p>However, the pandemic also had a few positive effects. For one, environmental conditions improved because industrial activity was severely restricted worldwide due to the lockdown, and traffic decreased. This led to a substantial reduction in greenhouse gas emissions. In India, for example, nitrogen dioxide levels fell by 71%, leading to an improvement in air quality. This improvement could be considered one of the few positive effects of the pandemic (<span class="citation" data-cites="NaveedEtAl2024">Naveed et al. (<a href="#ref-NaveedEtAl2024" role="doc-biblioref">2024</a>)</span>; <span class="citation" data-cites="SouzaEtAl2021">Souza et al. (<a href="#ref-SouzaEtAl2021" role="doc-biblioref">2021</a>)</span>). Secondly, the pandemic also had a profound impact on research and science. Although scientists faced challenges due to restrictions in their work processes, they also had to find creative solutions to develop vaccines that could combat the virus. A breakthrough came from BioNTech, which achieved a result in the development of vaccines against COVID-19 that led to global scientific collaboration. Research focused on many different areas of the virus, such as its structure, transmission routes, and the development of therapeutic approaches (<span class="citation" data-cites="ShiEtAl2020">Shi et al. (<a href="#ref-ShiEtAl2020" role="doc-biblioref">2020</a>)</span>).</p>
<p>Humanity was faced with a challenge unlike any it had seen before, due to the COVID-19 pandemic. The experience gained during this time will accompany society far into the future laying the basic building blocks for future measures in the health and education sectors as well as in the economy (<span class="citation" data-cites="NaveedEtAl2024">Naveed et al. (<a href="#ref-NaveedEtAl2024" role="doc-biblioref">2024</a>)</span>).</p>
</section>
<section id="overviews-of-stock-markets-ew-lf-mb" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="overviews-of-stock-markets-ew-lf-mb"><span class="header-section-number">2.4</span> Overviews of Stock Markets (EW, LF, MB)</h2>
<p>In the following sections, we will first introduce all the companies that represent our four areas of technology, tourism, pharmaceuticals and energy. The first company that reflects the tourism sector is Lufthansa. For the energy sector, we selected Shell, for the technology sector, Apple and finally, for the pharmaceutical area, we selected BioNTech. To provide a better understanding of our analysis and its results at the end, we will introduce the companies comprehensively. This also includes characterizing what exactly influenced the companies in the period from 2019 to 2023 and what they did during that time. After the company presentations, we will briefly describe their stocks from the Yahoo Finance data to provide a basic understanding from the start.</p>
<section id="lufthansa-brand-and-stock-overview-mb" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="lufthansa-brand-and-stock-overview-mb"><span class="header-section-number">2.4.1</span> Lufthansa Brand and Stock Overview (MB)</h3>
<p>Lufthansa, whose official name is Deutsche Lufthansa Aktiengesellschaft, was founded in 1926, and developed into one of the most well-known companies in the aviation industry. They hold one of the leading positions in the European domestic market with over 101,709 employees. In 2024, the company recorded a turnover of approximately 37,581 million euros, showing an increase of 6% compared to the previous year.</p>
<p>The group of companies consists of the business areas of passenger airlines, logistics, maintenance, repair, overhaul, and other businesses. The group of passenger airlines includes well-known providers such as Lufthansa Airlines, SWISS, Australian ITA Airlines and ITAAirways. These offer a variety of flights from the headquarters in Frankfurt, Munich, Zurich, Vienna, Brussels and Rome (<span class="citation" data-cites="LufthansaGroup2026">Lufthansa Group (<a href="#ref-LufthansaGroup2026" role="doc-biblioref">2026</a>)</span>). The group generated a lower operating profit of 1,6 billion euros in 2024, compared to 2,7 billion euros in the previous year, 2023. The decline compared to previous years was driven by various factors, particularly strikes, which caused high costs for passenger airlines. These amounted to a total value of approximately 450 million euros (<span class="citation" data-cites="SchmidXia2024">Schmid and Xia (<a href="#ref-SchmidXia2024" role="doc-biblioref">2024</a>)</span>). Despite these challenges, net income decreased less sharply to 1,7 billion euros in the previous year, to 1,4 billion euros, due to lower interest expenses. Lufthansa has successfully mastered many challenges in recent years. This includes, on the one hand, severe economic turbulence and an enormous increase in competitors in the aviation industry. On the other hand, the Covid-19 pandemic had severe negative effects on the entire industry (<span class="citation" data-cites="SchmidXia2024">Schmid and Xia (<a href="#ref-SchmidXia2024" role="doc-biblioref">2024</a>)</span>).</p>
<p>The Lufthansa Ag (LHA.DE) stock reveals a clear change between the years 2019 and 2023. At the beginning of 2019, the course started at 15,83 euros, but fell to 11,67 euros by the end of the year. In 2020, there was a radical decline due to the Covid-19 pandemic. This year’s rate was still at 9,80 euros in January and found itself at 7,73 euros in December. The following year, the stock started at 7.56 euros and reached a strong increase to 22,46 euro in the first quarter, but it had fallen back to 6,15 euros by December. In 2022, the stock gradually recovered, with a closing price of 7,77 euros in December. In January 2023, it closed at 9,69 euros before dropping to 7,99 euros in December.</p>
<p>Overall, the performance of Lufthansa shares exhibits that they suffered greatly from the effects of the pandemic (<span class="citation" data-cites="YahooLufthansa2026">Yahoo Finance (<a href="#ref-YahooLufthansa2026" role="doc-biblioref">2026c</a>)</span>; <span class="citation" data-cites="SchmidXia2024">Schmid and Xia (<a href="#ref-SchmidXia2024" role="doc-biblioref">2024</a>)</span>).</p>
</section>
<section id="shell-brand-and-stock-overview-ew" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="shell-brand-and-stock-overview-ew"><span class="header-section-number">2.4.2</span> Shell: Brand and Stock Overview (EW)</h3>
<p>The Shell Company was founded in 1833 by Marcus Samuel in London, who first worked as a dealer in antiques and later in oriental shells. In the 1880’s, the Samuel brothers began to work in the oil business. They revolutionized oil transport by building the first oil tanks, which led to the founding of the Shell Transport and Trading Company. In the 1990s, Shell started to invest in new technologies and expanded first into China and Russia. This was the foundation for the company’s international trade. Between 2005 and 2026, Shell restricted its operating structure to a uniform basis and focused on innovation, which led to the founding of the New Energies division for renewable energy (<span class="citation" data-cites="ShellStrategy2025">Shell (<a href="#ref-ShellStrategy2025" role="doc-biblioref">2025</a>)</span>)</p>
<p>These days, Shell has a strong market presence with an extensive global network of over 44,000 service stations and more than 96,000 employees in over 70 countries. Positioning itself as a leading provider in the lubricants sector and pursuing a strategy aimed at covering energy needs through sustainable practices. To minimize the impact on the environment and its ecological footprint, Shell invests billions annually in research and development for sustainable energy solutions.</p>
<p>Between 2019 and 2023, the company placed an even greater focus on transitioning to a more sustainable energy future. They invested in renewable energy to reduce its carbon emissions and adapted its traditional oil and gas business at the same time. Shell aims to achieve net-zero emissions by 2050 (<span class="citation" data-cites="ShellStrategy2025">Shell (<a href="#ref-ShellStrategy2025" role="doc-biblioref">2025</a>)</span>; <span class="citation" data-cites="Li2024">J. Li (<a href="#ref-Li2024" role="doc-biblioref">2024</a>)</span>).</p>
<p>In 2019, Shell plc (SHEL) stock, began at 61,73 US dollars and ended the year at approximately 58,98 US dollars. After that, it fell from 58,98 in early 2020 down to 35,14 US dollars until December. This sharp decline can be explained by the Covid-19 pandemic, in which active life was increasingly curtailed (<span class="citation" data-cites="ReutersShell2021">Bousso and Nasralla (<a href="#ref-ReutersShell2021" role="doc-biblioref">2021</a>)</span>). The following year, Shell was able to achieve a slight recovery from 36,89 US dollars to 43,40US dollars, but this did not bring them even close to their initial value in 2019. However, in 2022, Shell continued to experience strong increases and ended the year in December with a price of 60,14 US dollars. By the end of 2023, this value had amplified to 60,14 US dollars, showing a clear raise in demand.</p>
<p>Ultimately, it can be said that the Shell stock initially rose sharply, but eventually stabilized (<span class="citation" data-cites="YahooShell2026">Yahoo Finance (<a href="#ref-YahooShell2026" role="doc-biblioref">2026d</a>)</span>).</p>
</section>
<section id="apple-brand-and-stock-overview-lf" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="apple-brand-and-stock-overview-lf"><span class="header-section-number">2.4.3</span> Apple: BRand and Stock Overview (LF)</h3>
<p>Steve Jobs and Steve Wozniak founded Apple in 1976 and began developing the first commercially successful personal computer in a garage, inspired by the Altair 8800. Over time, the company released numerous groundbreaking products, such as iPod, iPhone, and Apple Watch. The year 2007 was particularly notable for Apple. In that year, they developed the first iPhone, which revolutionized communication as it had been known before (<span class="citation" data-cites="LiSun2023">M. Li and Sun (<a href="#ref-LiSun2023" role="doc-biblioref">2023</a>)</span>; <span class="citation" data-cites="BritannicaApple2026">Levy and Montevirgen (<a href="#ref-BritannicaApple2026" role="doc-biblioref">2026</a>)</span>).</p>
<p>Between 2019 and 2023, the company experienced both success and challenges caused by the pandemic. Revenue grew from 260,2 billion US dollars to 365 billion US dollars in 2021. Due to the high demand wave and new innovative products (<span class="citation" data-cites="LiSun2023">M. Li and Sun (<a href="#ref-LiSun2023" role="doc-biblioref">2023</a>)</span>; <span class="citation" data-cites="BritannicaApple2026">Levy and Montevirgen (<a href="#ref-BritannicaApple2026" role="doc-biblioref">2026</a>)</span>).</p>
<p>However, the Covid-19 Pandemic also presented unexpected challenges. The lockdowns led to enormous losses, up to 8 billion dollars, which made the vulnerability of the supply chains obvious. Despite these setbacks, Apple has maintained its role as market leader in recent years, due to its efficient ideas and technology. The company even boosted its market valuation of 3 trillion US dollars in 2022. Apple was also the first company to exceed this value and was able to further support their position in the market by introducing new products such as the Apple Watch and the AirPods (<span class="citation" data-cites="LiSun2023">M. Li and Sun (<a href="#ref-LiSun2023" role="doc-biblioref">2023</a>)</span>; <span class="citation" data-cites="BritannicaApple2026">Levy and Montevirgen (<a href="#ref-BritannicaApple2026" role="doc-biblioref">2026</a>)</span>).</p>
<p>Overall, the story of apple illustrates that the company is not only among the world’s most valuable brands thanks to its products, but due to its new innovations and attention to people’s demands (<span class="citation" data-cites="LiSun2023">M. Li and Sun (<a href="#ref-LiSun2023" role="doc-biblioref">2023</a>)</span>; <span class="citation" data-cites="BritannicaApple2026">Levy and Montevirgen (<a href="#ref-BritannicaApple2026" role="doc-biblioref">2026</a>)</span>).</p>
<p>In contrast to the other stocks, the Apple (AAPL) stock exhibits a nearly constant rise from 2019 to 2023. At the beginning of 2019, the stock opened at a price of 37,72 US dollars and rose to 73,41 US dollars by December 2020, Apple was able to achieve another slight amplification, as the stock rose from 74,06 US dollars to 132,96 US dollars from January to December. In 2021, Apple recorded an enhancement from 131,69 US dollars to 177,57 US dollars. The following year, the trend changed, because the stock fell from 177,57 US dollars at the beginning of the year to 129,93 US dollars until December. In 2023, the stock displayed new changes and presented an augment from 144,29 US dollars to 192,53 US dollars from January to December (<span class="citation" data-cites="YahooApple2026">Yahoo Finance (<a href="#ref-YahooApple2026" role="doc-biblioref">2026a</a>)</span>).</p>
</section>
<section id="biontech-brand-and-stock-overview-lf" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="biontech-brand-and-stock-overview-lf"><span class="header-section-number">2.4.4</span> BioNTech: Brand and Stock Overview (LF)</h3>
<p>The founding of BioNTech in 2008 by Professor Doctor Ugur Sahin, Professor Doctor Özlem Türeci, and Professor Doctor Christoph Huber, aimed to develop new therapies that would improve the well-being of people. In 2012, BioNTech began to treat cancer candidates for the first time with the help of mRNA immunotherapy during a clinical study. This study was based on mRNA technology, which was first used in drug development in the 1990s (<span class="citation" data-cites="BioNTechHistory2026">BioNTech (<a href="#ref-BioNTechHistory2026" role="doc-biblioref">2026</a>)</span>).</p>
<p>BioNTech was listed on the NASDAQ in 2019 with the ticker symbol BNTX. This led the company to a market valuation of 3,4 billion US Dollar. In 2020, when the COVID-19 pandemic broke out, BioNTech launched a new project, named Lightspeed. The goal of this project was to develop a vaccine to combat the COVID-19 pandemic and the wave of illness that affected people. To help control the disease, the company developed the Pfilzer-BioNTech COVID-19 vaccine in just ten months and quickly obtained approval for its use. This vaccine development is among the fastest in history (<span class="citation" data-cites="Noor2021">Noor (<a href="#ref-Noor2021" role="doc-biblioref">2021</a>)</span>).</p>
<p>Between 2021 and 2023, BioNTech continued to increase its research and activities. For example, in 2022, they announced the launch of the so-called BioNTrainer modules. These modules offer the possibility to produce mRNA-based medicines on a large scale. In the same year, the company expanded its collaborations and signed agreements with the British government, this partnership aimed to research new cancer immunotherapies based on mRna.</p>
<p>In 2023, BioNTech also did everything to be able to evaluate scientific research in the most modern way. To make this research possible, they acquired the technology company InstaDeep to expand AI-developed medications (<span class="citation" data-cites="BioNTechHistory2026">BioNTech (<a href="#ref-BioNTechHistory2026" role="doc-biblioref">2026</a>)</span>; <span class="citation" data-cites="InvesteuropeBioNTech2026">Invest Europe (<a href="#ref-InvesteuropeBioNTech2026" role="doc-biblioref">2026</a>)</span>).</p>
<p>These developments have led BioNTech transform from a small start-up to a global biotechnology company actively researching future medicine (<span class="citation" data-cites="InvesteuropeBioNTech2026">Invest Europe (<a href="#ref-InvesteuropeBioNTech2026" role="doc-biblioref">2026</a>)</span>).</p>
<p>The analysis of BioNTech’s SE (BNTX) stock price between 2019 and 2023 presents a rarely seen development. Due to the late initial public offering on October 10, 2019, no data is available at the beginning of this year, so the stock starts in October at 16,83 US dollars. The following year, the stock experienced a horizontal boost, which is why it was trading at 81,52 US dollars in December. This boost can be attributed to the rapid development of a vaccine against the coronavirus. In 2021, the opening price was already 335,65 US dollars and rose to 346,80 US dollars by the end of the year. However, in 2022, the stock recorded a loss, fell to 150,22 US dollars and in the following year another drops to 105,54 US dollars.</p>
<p>Overall, the radical increase and subsequent drop reflect the development of the vaccine from the time it was needed during the pandemic to the end of the pandemic (<span class="citation" data-cites="YahooBioNTech2026">Yahoo Finance (<a href="#ref-YahooBioNTech2026" role="doc-biblioref">2026b</a>)</span>; <span class="citation" data-cites="BioNTechHistory2026">BioNTech (<a href="#ref-BioNTechHistory2026" role="doc-biblioref">2026</a>)</span>; <span class="citation" data-cites="InvesteuropeBioNTech2026">Invest Europe (<a href="#ref-InvesteuropeBioNTech2026" role="doc-biblioref">2026</a>)</span>; <span class="citation" data-cites="Noor2021">Noor (<a href="#ref-Noor2021" role="doc-biblioref">2021</a>)</span>).</p>
</section>
</section>
</section>
<section id="methodology-ew" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Methodology (EW)</h1>
<p>This chapter is dedicated to methodology. One after the other, the two datasets from COVID and the stocks are cleaned to suit upcoming analyses. Next, a descriptive analysis of the stocks, followed by a prediction analysis through forecasts, can proceed. In addition, both time series become stationary laying the basis for a Granger causality test and a regression analysis.</p>
<section id="stock-data-extraction-and-cleaning-ew" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="stock-data-extraction-and-cleaning-ew"><span class="header-section-number">3.1</span> Stock Data Extraction and Cleaning (EW)</h2>
<p>The first data set was retrieved using the getsymbols() function from the <code>R</code> package <code>quantmod</code>. The <code>quantmod</code> package enables the automated retrieval and processing of financial market data directly from Yahoo Finance (<span class="citation" data-cites="RyanUlrich2023">Ryan and Ulrich (<a href="#ref-RyanUlrich2023" role="doc-biblioref">2023</a>)</span>). The <code>dplyr</code> package arranges data manipulation <em>i</em>n terms of filtering, selecting, and aggregating (<span class="citation" data-cites="Wickham2016">Wickham (<a href="#ref-Wickham2016" role="doc-biblioref">2016</a>)</span>). First, a vector is defined with the stocks to be analyzed and the corresponding tickers. “AAPL” refers to Apple stock, which represents the technology sector in this paper, ‘BNTX’ stands for Biontech, which represents the pharmaceutical industry, “LHA.DE” is Lufthansa Germany and represents the aviation industry, and finally “SHEL” represents the energy industry. Since the project specifically requires the time frame surrounding the coronavirus pandemic, the time frame for the data was selected from January 1, 2019, to December 31, 2023, and it downloads the daily stock market data. This automatically creates an <code>xts</code> time series object in the workspace for each ticker, which is then converted into a data frame. For each stock, this data frame includes the daily opening price (Open), the daily high (High), the daily low (Low), the daily closing price, and the traded volume of the stock (Volume). <code>Index()</code> converts the date into a normal column, <code>coredata()</code> takes the price values, and <code>data.frame()</code> combines everything into a data frame with the components already described, but for each stock individually (<span class="citation" data-cites="RyanUlrich2023">Ryan and Ulrich (<a href="#ref-RyanUlrich2023" role="doc-biblioref">2023</a>)</span>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installing Packages  </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"quantmod"</span>, <span class="st">"dplyr"</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading PACKAGES </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Ticker </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>tickers <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AAPL"</span>,      <span class="co"># Apple</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"BNTX"</span>,      <span class="co"># BioNTech</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LHA.DE"</span>,    <span class="co"># Lufthansa</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SHEL"</span>       <span class="co"># Shell</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Rawdate (Daily Prices) read in from 2019 until the end of 2023 </span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  tickers,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="st">"2019-01-01"</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">to   =</span> <span class="st">"2023-12-31"</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting very stock in a Dataframe </span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>AAPL_df  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> <span class="fu">index</span>(AAPL),   <span class="fu">coredata</span>(AAPL))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>BNTX_df  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> <span class="fu">index</span>(BNTX),   <span class="fu">coredata</span>(BNTX))</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>LHA_df   <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> <span class="fu">index</span>(LHA.DE), <span class="fu">coredata</span>(LHA.DE))</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>SHEL_df  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> <span class="fu">index</span>(SHEL),   <span class="fu">coredata</span>(SHEL))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In the next step, the closing prices of the respective stocks were extracted using the <code>Cl()</code> function, which is included in the <code>quantmod</code> package. A conscious decision was made to use only the closing prices, as the remaining values are not useful for the analysis. To visualize the adjusted result, the <code>xts</code> package was used, which in turn illustrates the data in a time series (<span class="citation" data-cites="RyanUlrich2023">Ryan and Ulrich (<a href="#ref-RyanUlrich2023" role="doc-biblioref">2023</a>)</span>). The first difficulty arose after R misinterpreted the object name due to the “dot” and backticks (<code>`</code>) had to be used. The <code>merge()</code> function now combines all four time series, but this led to further difficulties because the four time series each have different data on which days they were traded. We then discovered that this was due to the different stock exchanges where the shares are traded. Lufthansa is traded on the German stock exchange and the other three on the US stock exchange, which is why they differ completely in terms of holidays, trading calendars, and currency (<span class="citation" data-cites="NYSE2023">NYSE (<a href="#ref-NYSE2023" role="doc-biblioref">2023</a>)</span>; <span class="citation" data-cites="DeutscheBoerse2023">Deutsche Börse (<a href="#ref-DeutscheBoerse2023" role="doc-biblioref">2023</a>)</span>). This was also evident in the example of April 13, 2020, which was Easter Monday and a public holiday in Germany, but not in the US, making Lufthansa the only one of the three stocks that had no value on that day. In addition, as we later discovered, Biontech’s IPO did not take place until October 10, 2019, which is why we also lacked the values before the pandemic (<span class="citation" data-cites="NADAQBioNTech2019">NASDAQ (<a href="#ref-NADAQBioNTech2019" role="doc-biblioref">2019</a>)</span>). To remedy this problem, the code was supplemented with <code>all = true</code>, so that all trading days are retained. If a stock was not traded on a given day, the missing value was replaced by <code>NA</code>. After this problem was identified and fixed, the individual columns were named with the company names and the <code>xts</code> object was converted into a classic data frame. With <code>index()</code>, the date is converted into a column and with <code>coredata()</code>, the numerical price values are assigned to the respective data as individual columns. This was necessary in order to neatly combine all four stocks into a data frame and make them evaluable, as <code>getsymbols()</code> does not provide data frames and time series from different markets cannot be combined line by line, but must be merged separately by date (<span class="citation" data-cites="RyanUlrich2023">Ryan and Ulrich (<a href="#ref-RyanUlrich2023" role="doc-biblioref">2023</a>)</span>).</p>
<p>The resulting <code>merged_cl</code> dataframe now contains the closing values of the four stocks for each date in the given time period, separated into individual columns next to each other. Initially, the idea was not only to break down the dataset to the closing values, but also to reduce the total number of closing values from daily to quarterly in order to simply work with less data. However, we rejected this idea for various reasons, such as the fact that it makes it more difficult to visualize the data, distorts or overgeneralizes the results, and generally complicates further analysis steps.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loading Packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting Closing Prices </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>LHA_cl  <span class="ot">&lt;-</span> <span class="fu">Cl</span>(<span class="st">`</span><span class="at">LHA.DE</span><span class="st">`</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>BNTX_cl <span class="ot">&lt;-</span> <span class="fu">Cl</span>(BNTX)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>AAPL_cl <span class="ot">&lt;-</span> <span class="fu">Cl</span>(AAPL)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>SHEL_cl <span class="ot">&lt;-</span> <span class="fu">Cl</span>(SHEL)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  Merging Timeseies after Date</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>merged_cl <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  LHA_cl, BNTX_cl, AAPL_cl, SHEL_cl,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">all =</span> <span class="cn">TRUE</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Name Columns</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(merged_cl) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Lufthansa"</span>, <span class="st">"BioNTech"</span>, <span class="st">"Apple"</span>, <span class="st">"Shell"</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert into Dataframe</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>closing_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">index</span>(merged_cl),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coredata</span>(merged_cl)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(closing_table)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(closing_table))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="covid-dataset-extraction-cleaning-and-visualization-ew" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="covid-dataset-extraction-cleaning-and-visualization-ew"><span class="header-section-number">3.2</span> COVID Dataset Extraction, Cleaning and Visualization (EW)</h2>
<p>Finding a suitable COVID dataset ultimately proved to be much more difficult than expected. Since the stocks in question are traded worldwide and daily values are involved, a COVID dataset containing global daily pandemic data is also required. However, we were initially unable to find a suitable dataset that met these criteria, as the datasets often did not contain daily data or were not valid. After initially working with a very small and scientifically invalid dataset, we realized that we could not perform any further analysis based on it and decided to look for a new dataset, which we found on the John Hopkins University Github (<span class="citation" data-cites="JHU2023">Johns Hopkins University (<a href="#ref-JHU2023" role="doc-biblioref">2023</a>)</span>). This dataset must also be viewed critically, as absolute perfection is not guaranteed here either and the number of unreported cases may have differed (<span class="citation" data-cites="WHO2020">World Health Organization (<a href="#ref-WHO2020" role="doc-biblioref">2020</a>)</span>). However, the scientific standard is sufficient for the given analysis purposes.</p>
<p>The raw data consists of two separate tables in “wide” format. One table contains confirmed COVID-19 cases and the other contains COVID-19-related deaths. In both tables, each row represents a geographical unit (country or subregion/province). The first columns contain the country/province name and its geographical coordinates. The temporal dimension is represented in “wide” format in a number of date columns, covering the period from January 22, 2020, to March 9, 2023, with each column representing a specific calendar day. The tables contain the cumulative number of cases and deaths reported up to that date (<span class="citation" data-cites="DongDuGardner2020">Dong, Du, and Gardner (<a href="#ref-DongDuGardner2020" role="doc-biblioref">2020</a>)</span>). Since this “wide” format posed a considerable difficulty for our work and is rather unsuitable, the first step after successfully loading the data with the <code>read.csv()</code> function was to convert the tables from ‘wide’ to “long” format using <code>pivot_longer()</code>, which converts all date columns into a common date variable with the corresponding column confirmed or deaths (<span class="citation" data-cites="WickhamEtAl2019">Wickham et al. (<a href="#ref-WickhamEtAl2019" role="doc-biblioref">2019</a>)</span>). This is followed by grouping by country and date (<code>group_by(country.region, date)</code>) and summing provinces/states to a country value per day. <code>.group = “drop”</code> ensures that the grouping no longer has any effect, which we did not notice at the beginning and which then proved to be our undoing as we continued coding.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c("tidyverse", "lubridate", "zoo"))</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pakete laden</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Johns-Hopkins COVID-19 Daten loading (confirmed &amp; deaths)</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>confirmedraw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>deathsraw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv"</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirmed Cases: Wide → Long and aggregation at country level</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>confirmed <span class="ot">&lt;-</span> confirmedraw <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(Country.Region, Province.State, Lat, Long),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"date"</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"confirmed"</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country.Region, date) <span class="sc">%&gt;%</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">confirmed =</span> <span class="fu">sum</span>(confirmed), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The same process as for the confirmed values was then also applied to the deaths values.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deaths: Wide → Long and aggregation at country level</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>deaths <span class="ot">&lt;-</span> deathsraw <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(Country.Region, Province.State, Lat, Long),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"date"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"deaths"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country.Region, date) <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">deaths =</span> <span class="fu">sum</span>(deaths), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Once both data frames had been converted to the correct format, they could be merged using <code>full_join()</code>, which merges the confirmed and deaths values based on the country and date. Even if values are missing in some records, these are replaced with <code>NA</code>, as all rows are retained. In the next step, the date had to be repaired and the leading “<code>X</code>” removed so that the text could be converted into a real date object (<code>mdy(date)</code>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge of confirmed and deaths</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>country <span class="ot">&lt;-</span> <span class="fu">full_join</span>(confirmed, deaths, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Country.Region"</span>, <span class="st">"date"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">gsub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, date),        </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">"/"</span>, date),      </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">mdy</span>(date)                    </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In order to obtain global values, a global aggregation was performed on a daily basis. However, in initial trials, <code>NA</code>s often occurred due to missing values. Ultimately, this problem was prevented by using <code>sum(..., na.rm=True)</code> to ensure that entire daily totals did not become <code>NA</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Worldwide aggregation per day</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> country <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">confirmed =</span> <span class="fu">sum</span>(confirmed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">deaths    =</span> <span class="fu">sum</span>(deaths, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>To visualize the results obtained so far, the confirmed values from the world table were visualized using <code>ggplot()</code>, with the date noted on the X-axis and the worldwide confirmed cases forming the Y-axis unit (<span class="citation" data-cites="Wickham2016">Wickham (<a href="#ref-Wickham2016" role="doc-biblioref">2016</a>)</span>). However, the initial result was not entirely satisfactory for various reasons, such as the fact that the data was cumulative but labeled as daily, the date was not clearly presented as a date, and a bar chart for daily time series is rather confusing. In the new code, this was corrected by correctly noting the date as described above, adjusting the labeling to cumulative, and changing the format to a line plot, as this is much clearer and more concise. As a result, we obtained a plot that is much clearer and easier to interpret and already provides a good insight into the pandemic events. Since these are cumulative cases, the plot is strictly monotonically increasing with a linear-like slope in the period from 2020 to 2022. At the beginning of 2022, however, an extreme slope can be seen, which continues until the middle of the year and indicates a sharp increase in the infection rate during this period. After this sharp increase, the rate of confirmed cases continues to grow steadily, but at a significantly slower pace.</p>
<div id="fig-logo" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-logo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="CovidPlot1.png" class="img-fluid figure-img" style="width:8cm">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Global Confirmed COVID-19 Cases
</figcaption>
</figure>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time Series Plot of global confirmed cases </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(world, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> confirmed)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Global Confirmed COVID-19 Cases"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Confirmed cases"</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>However, in order to obtain an even better picture of the pandemic, we subsequently decided to use daily confirmed cases instead of cumulative confirmed cases, as this might be even more suitable for visualization. Therefore, we took the approach of calculating the difference between today’s value and yesterday’s value, as this gives the value of the daily new cases (<code>confirmed – lag(confirmed)</code>), which could then be added to the world table. Arrange() sorts the values chronologically so that the difference is calculated correctly. The first row of the table has no previous day, which is why NA becomes zero (<code>replace_na (..., 0)</code>). However, we only noticed this later, which is why the code did not work. Another problem was negative daily new values, which arose as a result of subsequent data correction (<span class="citation" data-cites="DongDuGardner2020">Dong, Du, and Gardner (<a href="#ref-DongDuGardner2020" role="doc-biblioref">2020</a>)</span>). <code>pmx(..., 0)</code> sets these to zero and solved the problem. </p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculation of daily new cases</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span>                       </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_confirmed =</span> confirmed <span class="sc">-</span> <span class="fu">lag</span>(confirmed), </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_confirmed =</span> <span class="fu">replace_na</span>(new_confirmed, <span class="dv">0</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_confirmed =</span> <span class="fu">pmax</span>(new_confirmed, <span class="dv">0</span>)       </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>When visualizing the daily new cases, the same code base as for the cumulative cases was initially used, but it quickly became apparent that this did not work right away with the revised data, as excessive short-term fluctuations and reporting-related volatility distorted the plot. Therefore, a 7-day average was calculated using the <code>rollmean()</code> function, which smooths out the strong daily fluctuations and sets NA at the beginning, where the first seven days are not yet available (<code>fill=NA</code>) (<span class="citation" data-cites="ZeileisGrothendieck2005">Zeileis and Grothendieck (<a href="#ref-ZeileisGrothendieck2005" role="doc-biblioref">2005</a>)</span>). However, this process did not work either, as <code>rollmean()</code> is included in the zoo package and this had to be installed first. Log transformation achieves better scaling and extreme peaks are less dominant; the +1 is essential here to prevent <code>log(0)</code> (<span class="citation" data-cites="Wooldridge2020">Wooldridge (<a href="#ref-Wooldridge2020" role="doc-biblioref">2020</a>)</span>). Finally, the analysis period is limited to the phase from February 2020 onwards in order to avoid distortions caused by the very early phase of the pandemic with extremely low case numbers and to ensure a consistent time series structure (<code>filter(date &gt;= ...</code>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading Package for moving average</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 7-day average and log transformation</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>world_plot <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">new_confirmed_ma7 =</span> <span class="fu">rollmean</span>(new_confirmed, <span class="dv">7</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_new_confirmed_ma7 =</span> <span class="fu">log</span>(new_confirmed_ma7 <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2020-02-01"</span>))    </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now, the time series plot of the logarithmic daily new infections could also be created using the same procedure as for the first time series plot. However, the X-axis shows the date February 2020 and the Y-axis shows the logarithmic daily new infections. The time series shows a very sharp increase in newly confirmed COVID cases at the beginning of the pandemic, reflecting the rapid global spread of the virus. From mid-2020 onwards, the curve becomes much more even and is characterized by recurring waves. These fluctuations indicate several global waves of infection, the intensity of which varies over time. A particularly pronounced peak can be seen at the beginning of 2022, followed by a gradual decline in case numbers, which is also clearly visible in the first plot. Towards the end of the observation period, the time series shows an overall downward trend, indicating a slowdown in the global infection dynamics (<span class="citation" data-cites="WHO2020">World Health Organization (<a href="#ref-WHO2020" role="doc-biblioref">2020</a>)</span>).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="CovidPlot2.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Log Daily New Confirmed COVID Cases</figcaption>
</figure>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time series plot of logarithmic daily new infections</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(world_plot, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> log_new_confirmed_ma7)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Log Daily New Confirmed COVID-19 Cases Worldwide (7-day average)"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"log(daily new confirmed cases + 1)"</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="descriptive-analysis-lf" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="descriptive-analysis-lf"><span class="header-section-number">3.3</span> Descriptive Analysis (LF)</h2>
<p>To provide a broad overview of the volatility of the stocks and to become more familiar with the basic data of the project, time series plots are created. These are known because of their use in business programs or also from stockbrokers. This descriptive approach has helped us to identify initial signs that bring us closer to the research question. The plots are also created with closing prices for each stock to ensure a stronger comparison. Besides, it is visible how the stocks behaved before COVID and with the onset of COVID and after. Moreover, as mentioned before, the volatility during the pandemic is evident, as is how or whether a stock has recovered until 2023. Next, it is exciting to compare these metrics regarding the different sectors of the four stocks.</p>
<p>Even before illustrating the individual stocks and their plots, preparatory work needs to be done. In order to clearly display the time series as plots, the packages <code>tsibble</code> and <code>feasts</code> must be installed once. Next, all essential packages described in the code above must be downloaded. Since the data has already been extracted and cleaned and each stock is defined with individual symbols, the code can be executed for each stock.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert time series into a dataframe</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>aapl_df <span class="ot">&lt;-</span> AAPL <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Date"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, <span class="at">Close =</span> AAPL.Close) <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Date)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#plot daily closing prices</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(aapl_df, Close) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Apple (AAPL)"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Daily closing price, 2019–2023"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Close (USD)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In the example of Apple, the first necessary step is to transform the given Apple data into a data frame due to Apple being a <code>xts</code> object after the stocks were defined as symbols. To illustrate the <code>autoplot</code> efficiently, one has to define the date as a single column and transform it into a data type to ensure better accuracy of the solution. For simplicity, the column from Apple’s previous closing dates is named Close. Also, in this step the data frame is reduced to two variables: Date and Close for daily closing prices. In the last step before creating the <code>autoplot</code>, the data frame is converted into <code>tsibble</code>. This means that the data is converted into a tidy structure, and the <code>index Date</code> is created with no need for a key variable due to Apple being the sole time series for this plot. Consequently, the key is needed for plots of more than one time series. (<span class="citation" data-cites="WangCook2021">Wang and Cook (<a href="#ref-WangCook2021" role="doc-biblioref">2021</a>)</span>). Lastly, the plot can be generated. Since the plot recognizes that it is a <code>tsibble</code>, the axis description implies that the index is on the x-axis, and the corresponding variable of close data is on the y-axis. For a better overview, only the title and subtitle need to be defined, and additional details of the currency need to be added to the close data. The plot is then ready to be generated. The code is the same for every other stock, just symbols that show which data it is, have to be changed to the stock’s individual symbols and data.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TSApple.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Timeseries Apple</figcaption>
</figure>
</div>
<p>Based on the finished Apple plot, a continuous line with a general trend over the four years is evident. The trend is visibly positive and shows sustainable growth of Apple’s market prices despite several minor dips. Regarding the phase before the pandemic until February and March 2020, the stock price has continuously developed. When COVID started, the price declined and also reached its low point at approximately the end of March 2020. A reason for this drop could be the uncertainty of the market participants, which could have led to selling their shares of Apple and consequently the stock price falls. Besides, one can see a fast recovery to the stock prices’ old level and also a higher volatility since mid-2020 throughout the following time span with recurring ups and downs. With obviously better figures regarding the pandemic since 2023, the stock price also reached its peak by the end of 2023.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TSBiontech.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Timeseries Biontech</figcaption>
</figure>
</div>
<p>In contrast to Apple’s plot, there is no clear sustainable positive trend throughout the four years for BioNTech’s daily closing stock prices visible. They behave in general extremely volatilely. Due to the late entry into the stock market, only a small increase in the stock price is remarkable until the start of the pandemic. With the beginning of COVID, a direct boom of the market price is evident leading to a strong positive trend with an increased effect from the beginning of 2021, resulting in a peak in mid-2021 with a market price of over 400 US dollars. One reason for the high increase in the market price could be that BioNTech is one of only few companies that released a vaccine to protect people against COVID-19. It can be observed that after the peak there is a drastic price decline, especially since 2022 and the initially positive trend since the beginning becomes negative till 2024 while COVID figures also decline. The price returns to its normal level shortly before the pandemic.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TSLufthansa.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Timeseries Lufthansa</figcaption>
</figure>
</div>
<p>With regard to Lufthansa, Lufthansa’s stock prices had a negative development over the course of the four years compared to 2019 and the other stocks. Lufthansa’s daily closing prices directly reached its peak in early 2019 with over 15 Euros per share and had a few declines before the pandemic but recovered again. However, with the beginning of the global pandemic, Lufthansa’s stock has changed sustainably with a lower price level. An immediate crash in the stock price is observable in early 2020, implying that the stock is worth only a third compared to the former value of 2019. This could be due to the fact that flying was prohibited for many people at this time, and there were also complications with travelling throughout the COVID pandemic. This could be seen in Germany, where Lufthansa is listed on the stock exchange, when people needed a negative COVID test and entry regulations could change fast (The Federal Government, 2021). There are a few small recovery phases which are characterized by volatility remarkable, leading to a strong increase in the stock price in the beginning of 2023 of over 10 Euros per share again for the first time since COVID. However, the stock never returned to its old price level again.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TSShell.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Timeseries Shell</figcaption>
</figure>
</div>
<p>As with regard to Lufthansa, Shell’s stock price has been on a downward trend for some time and is characterized by volatility. However, before the pandemic, a relatively stable price level of over 60 dollars per share can be observed. During the start of COVID, Shell’s stock price crashed drastically from 60 to nearly 20 dollars per share in a short period, leading to high volatility in the first two quarters of 2020. Shortly before the start of the quarter, a sharp price increase can be seen, followed by a sustainable positive trend despite high volatility till 2024. In contrast to Lufthansa, Shell’s stock price could return to its previous price level in mid-2022, which could improve further despite some downs over the next year. It peaked at the end of 2023, exceeding the pre-COVID price level.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Timeplot for all stocks</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#load packages</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#cobine all stcoks into one dataset</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>all_stocks <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(aapl_df) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Stock =</span> <span class="st">"AAPL"</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(bntx_df) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Stock =</span> <span class="st">"BNTX"</span>),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(lha_df)  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Stock =</span> <span class="st">"LHA.DE"</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(shel_df) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Stock =</span> <span class="st">"SHEL"</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Date, <span class="at">key =</span> Stock)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#plot daily closing prices</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(all_stocks, Close) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Daily closing prices (2019–2023)"</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"AAPL vs BNTX vs LHA.DE vs SHEL"</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Close Price"</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The idea was then to clearly show all four stocks in a single plot. Therefore, a download of the packages <code>dplyr</code>, <code>tsibble</code> and <code>feasts</code> is necessary. The next step is to combine all four stocks and their data into one data set by bind_rows and add a new variable through mutate that assigns the daily ending close price reliable to its corresponding stock. In addition, the data set is converted into a <code>tsibble</code>. As with the individual plots, the index is also defined as Date in this code. A new addition is the key variable corresponding to the stocks, as there are several time series. Then one just needs to add to the plot that it should illustrate all stocks and with their prices and add labels to it to generate the plot.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TSCombined.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Combined Timeseries</figcaption>
</figure>
</div>
<p>However, although the plot is structurally correct and the code therefore works, the image is distorted. The reason lays in the significantly different amount of market prices of the stocks. It is easy to recognize BioNTech’s and Apple’s time series, but Lufthansa’s and Shell’s plots and their volatility are hardly visible. To create a suitable comparison, a new approach is needed. The new approach is based on an index. This means that every stock and their closing prices start at a specific amount, in this case at 100. This allows you to see the relative performance of the stock based on the 100. Besides, due to BioNTech’s rapid increase in their stock price, it would distort the image despite the index. For this reason, a logarithmic scale is introduced that reduces especially the illustration of BioNTech’s plot by balancing the development of the stock price in proportion. This implies that the plot would increase in the same way if a stock price developed from 50 to 100 dollars or from 100 to 200 dollars.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Timeplot for all stocks with indexed stock prices</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#combine all stocks in one dataset with computing indexed prices</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>all_stocks <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(aapl_df) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Stock=</span><span class="st">"AAPL"</span>),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(bntx_df) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Stock=</span><span class="st">"BNTX"</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(lha_df)  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Stock=</span><span class="st">"LHA.DE"</span>),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(shel_df) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Stock=</span><span class="st">"SHEL"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Stock, Date) <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Stock) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Index =</span> Close <span class="sc">/</span> <span class="fu">first</span>(<span class="fu">na.omit</span>(Close)) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Date, <span class="at">key =</span> Stock)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#plot indexed prices</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(all_stocks, Index) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Indexed Stock Prices"</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"AAPL vs BNTX vs LHA.DE vs SHEL"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Index"</span>,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The new code is just a revised version of the old code. The difference only comes after the download of the packages and the combined data set. For the preparation of the index, an arrangement is needed that every stock has their closing prices in chronological order, following the separation of each stock and their dates through <code>group_by(Stock)</code>. This lays the basis for calculating the stock’s index individually. The index has a new value every day by dividing the close price of the stock every day by the first available close price that can be found, times 100. The plot shows the daily change to the first available closing price that has an index of 100. The separation can be repealed, and the data set can be converted into <code>tsibble</code>. The last adjustment to the previous code is the log-scale on the y-axis to the basis of 10 to improve comparability. Through the assignment of the index and key variable and the labeling to the plot the code is complete. Consequently, close price is replaced by index on the y-axis.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="TSIndexed.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Indexed Timeseries Combined</figcaption>
</figure>
</div>
<p>This plot has many advantages in comparison to the old one. It not only better shows the volatility of individual stocks, but it also shows the relative development of the stocks. Besides, due to relative prices, differences in currencies can be neglected and improve comparability. The plot clearly shows Apple’s sustainable positive trend and BioNTech’s strong stock price increase and decrease compared to the others. This index also clearly illustrates Shell’s recovery phase and Lufthansa’s sustainable trend below its pre-COVID price level. However, due to BioNTech’s initial low-price level, the index cannot be interpreted in the way that the stock has grown strongly in the long term.</p>
</section>
<section id="predictive-analysis-mb" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="predictive-analysis-mb"><span class="header-section-number">3.4</span> Predictive Analysis (MB)</h2>
<p>After the descriptive analysis of the four stocks, the next step regarding the research question is a predictive analysis. In this project, based on available closing prices, one attempts to predict what the stock plot would look like without the data from March 2020 onwards during the pandemic. Therefore, the forecasting method is used. It is important to design the forecasts realistically due to affecting directly the reliability of the results as they are also used by companies to improve their future decision making (<span class="citation" data-cites="AthanasopoulosHyndman2021a">Athanasopoulos and Hyndman (<a href="#ref-AthanasopoulosHyndman2021a" role="doc-biblioref">2021a</a>)</span>). Inspired by the website of Athanaspopoulos and Hyndman, we decided to use ARIMA models, as they suit our data and are a common method (<span class="citation" data-cites="AthanasopoulosHyndman2021b">Athanasopoulos and Hyndman (<a href="#ref-AthanasopoulosHyndman2021b" role="doc-biblioref">2021b</a>)</span>).</p>
<p>In order to enable direct comparison, the idea is to show both the forecast and the actual time series plot for the respective stock in a single plot. Our initial approach has a few limitations.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lufthansa forecast</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fable)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">getSymbols</span>(<span class="st">"LHA.DE"</span>, <span class="at">src=</span><span class="st">"yahoo"</span>, <span class="at">from=</span><span class="st">"2019-01-01"</span>, <span class="at">to=</span><span class="st">"2023-12-31"</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># convert Lufthansa xts object into a tidy data frame</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>lha_raw <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(LHA.DE) <span class="sc">|&gt;</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Date"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">Close =</span> <span class="fu">as.numeric</span>(LHA.DE[,<span class="dv">4</span>])) <span class="sc">|&gt;</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, Close)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># create a complete daily date sequence</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>full_dates <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2019-01-01"</span>),</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>             <span class="fu">as.Date</span>(<span class="st">"2023-12-31"</span>),</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">by=</span><span class="st">"day"</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co"># merge full calendar with observed prices and convert to tsibble</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>lha <span class="ot">&lt;-</span> full_dates <span class="sc">|&gt;</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(lha_raw, <span class="at">by=</span><span class="st">"Date"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Date)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co"># define the training dataset (pre-COVID period)</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>lha_train <span class="ot">&lt;-</span> lha <span class="sc">|&gt;</span> <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="st">"2020-03-01"</span>)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co"># fit ARIMA model on training data</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>lha_fit <span class="ot">&lt;-</span> lha_train <span class="sc">|&gt;</span> <span class="fu">model</span>(<span class="fu">ARIMA</span>(Close))</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co"># generate forecast for three years</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>lha_fc <span class="ot">&lt;-</span> lha_fit <span class="sc">|&gt;</span> <span class="fu">forecast</span>(<span class="at">h=</span><span class="st">"3 years"</span>)</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co"># plot forecast vs actual prices</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>lha_fc <span class="sc">|&gt;</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(lha) <span class="sc">+</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="st">"Lufthansa (LHA.DE) — ARIMA Forecast vs Actual"</span>,</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle=</span><span class="st">"Model trained on data before March 2020"</span>,</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="st">"Date"</span>,</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="st">"Close Price (EUR)"</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In the old codes, the stocks data were again extracted from Yahoo as well as their closing prices and individually defined as symbols. The stock price data are converted into a daily price calendar, and the ARIMA model was trained on data before March 2020 to generate a forecast for the following three years against the stock’s actual observed time series. Although the forecast worked, there were gaps in the plot after the code was executed. The reason for this is that the plot contains data every day, so <code>NA</code> dates are introduced for missing values of the dataset due to non-trading days. This prevents the <code>autoplot</code> from connecting the lines over the missing dates. To ensure a better illustration, the last observed price is carried forward to the next trading date, just for visual purposes.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lufthansa correct forecast</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lufthansa: Close </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>lha_raw <span class="ot">&lt;-</span> closing_table <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date), <span class="at">Close =</span> Lufthansa)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Full daily calendar </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>lha <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Date =</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2019-01-01"</span>), <span class="fu">as.Date</span>(<span class="st">"2023-12-31"</span>), <span class="at">by =</span> <span class="st">"day"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(lha_raw, <span class="at">by =</span> <span class="st">"Date"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Date)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ARIMA: train pre-COVID</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>lha_fit <span class="ot">&lt;-</span> lha <span class="sc">%&gt;%</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">"2020-03-01"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model</span>(<span class="at">arima =</span> <span class="fu">ARIMA</span>(Close))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>lha_fc <span class="ot">&lt;-</span> lha_fit <span class="sc">%&gt;%</span> <span class="fu">forecast</span>(<span class="at">h =</span> <span class="st">"3 years"</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward fill NAs for visualization only</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>lha_plot <span class="ot">&lt;-</span> lha <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date) <span class="sc">%&gt;%</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(Close, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Date)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>lha_fc <span class="sc">%&gt;%</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(lha_plot) <span class="sc">+</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Lufthansa (LHA.DE) — ARIMA Forecast vs Actual"</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model trained on data before March 2020"</span>,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Close Price (EUR)"</span>,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The revised version also shows a simplification of the code. Since the data for the individual stocks has already been downloaded and the close prices have already been extracted, one can directly pull the data from the <code>closing_table</code>. Then a new table with the closing_table data can be created with, in this case, Lufthansa’s closing prices and their corresponding dates. A <code>tsibble</code> for the preparation for the ARIMA model is needed after a daily calendar as with in the old code, is generated. The difference is that through <code>left_join NA</code> values for non-trading days come up, explaining the gaps in the original plot. Next, the ARIMA model is trained with pre-March 2020 observations and regarding the projects’ time scope limited to the following three years with prediction intervals and a mean forecast. The aforementioned visual improvement of forward filling is achieved by <code>fill(Close, .direction = “down”)</code>. This is appropriate due to transforming the data into a tibble in chronological order as preparation. The last step before just labeling the <code>autoplot</code>, is to convert the data back into a <code>tsibble</code> and use the data which include the forward filling values for the <code>autoplot</code>. The general forecast stays the same; however, the visualization improved.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="FCLufthansa.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Forecast Lufthansa</figcaption>
</figure>
</div>
<p>The plot clearly shows the forecast without a single price prediction but rather with a range of values in which the stock would likely have traded based on pre-COVID data next to the actual closing prices. The dark and light blue ranges map the 80 and 95 percent prediction intervals. These percentages are probabilities and represent a price range for a stock. This means that it is a 95% probability that the stock’s closing price will lay in this range. The horizontal line is the forecast mean which estimates the mean share price based on given data. Lufthansa’s forecast plot could indicate that the pandemic may have contributed to Lufthansa’s worse performance than expected based on the data before. Even with a wide range of prediction intervals that already assume high volatility, the actual closing prices still remain below the broader prediction interval most of the time during the three years. Moreover, one can directly see that after the shock and crash of the stock price at the start of the pandemic, the values are always below the forecast mean. However, it can be seen twice that the time series enters the 95% prediction interval. The first time is around the beginning of 2021 and the second time after three years, even entering the 80% range. The forecast also supports the descriptive analysis that Lufthansa’s stock decreased sustainably during COVID-19 with a lower price level than expected.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="FCApple.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Forecast Apple</figcaption>
</figure>
</div>
<p>The forecast suggests, based on the given data, a lower uncertainty in comparison to Lufthansa’ stock price. Apple’s plot proves the opposite. After a short crash at the beginning of 2020 where the stock is at least in the upper 80 percent prediction interval, the closing prices show a steady positive development. They exceed the forecast mean, as well as the ranges where the prices are expected to be. Apple, as a tech stock, outperformed its expected price ranges and recovered fast by only briefly staying in the expected range.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="FCShell.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Forecast Shell</figcaption>
</figure>
</div>
<p>In comparison to the other two stocks, Shell’s stock shows a different development. The closing prices recovered in the long term better than Lufthansa but not as fast and not to the extent in comparison to Apple. Once again, there is high volatility and a huge crash in the share price evident which cannot be explained by pre pandemic data. However, the stock price enters the prediction intervals early 2022, implying a return to the pre-COVID baseline, despite even some downs after, and positive increases. In addition, shortly before the time period ends, the forecast mean is exceeded and in general a sustainable long-term recovery to the stock’s old price level can be seen.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="FCBiontech.png" class="img-fluid figure-img" style="width:8cm"></p>
<figcaption>Forecast BioNTEch</figcaption>
</figure>
</div>
<p>The last forecast highlights a limitation of our approach. Due to the small pre- pandemic dataset of BioNTech and no identification of a trend, the graph cannot be meaningfully interpreted, and the outcome would be unreliable. It should also be noted that the stock is a special case, as it is difficult to predict an invention such as the vaccine which can have a major influence on a stock’s demand and price level.</p>
<p>In conclusion, all stocks developed differently regarding the baseline predicted by the ARIMA model. This can indicate that COVID had an impact on the stock’s prices, especially regarding the immediate crashes of the stocks at the beginning of the pandemic. However, there is still no causal connection between COVID and stocks. One could assume that the tourism sector has been hit hardest, followed by the energy sector. The technology sector, however, seems to be unaffected by the pandemic or could even be impacted positively. BioNTech, as a pharmaceutical stock, also could profit from the crisis regarding the vaccine but without sustainable growth.</p>
<p>After creating the forecast, we noticed that the forecasts can also be used to interpret the stock recovery. Therefore, the forecast serves as a counterfactual baseline meaning that the recovery is assessed at the point when the stock reenters the expected range in which they would likely have traded, defined here as the 80 percent prediction interval. About this definition of recovery in this project’s case, Lufthansa’s stock suggests a slow and inconsistent recovery as it remains below the intervals for the most time of the period in contrast to rapid recovery and outperformance of Apple’s. Shell’s stock recovered at a slower rate but in a sustainable manner, while no robust interpretation of BioNTech can be made due to its late stock market entry.</p>
</section>
<section id="granger-causality-analysis-mb" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="granger-causality-analysis-mb"><span class="header-section-number">3.5</span> Granger Causality Analysis (MB)</h2>
<p>To examine to what extent Covid-19 had an influence on each sector, including their stock performance, one must combine our COVID dataset with the stocks’ prices. After testing whether the datasets are stationary, a transformation of the stocks and the pandemic data into stationary data is needed. This lays the basis for the Granger causality test.</p>
<section id="stationarity-test-mb" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="stationarity-test-mb"><span class="header-section-number">3.5.1</span> Stationarity Test (MB)</h3>
<p>A stationary time series does not follow a specific trend; the values rather concentrate and fluctuate around the mean. This implies that the time series has a constant mean and variance and does not change its statistical features (<span class="citation" data-cites="PetricaEtAl2017">Petrica, Stancu, and Ghitulescu (<a href="#ref-PetricaEtAl2017" role="doc-biblioref">2017</a>)</span>). Although a clear trend with regard to the time series plots is visible, a stationarity test ensures safety. To test the stationarity of our data, the ADF, Augmented Dickey-Fuller, test suits our type of data the best by testing whether the time series has a unit root. The test is based on two hypotheses: H0 and H1. The null hypothesis states that the time series is not stationary and has a unit root, while the alternative hypothesis therefore states the opposite (<span class="citation" data-cites="Li2017">B. Li et al. (<a href="#ref-Li2017" role="doc-biblioref">2017</a>)</span>).</p>
<p>In the first step, we provided a more detailed version of the ADF test which, however, would not have been necessary in terms of finding out if the time series of the stocks have a unit root. This code has again extracted the closing prices to then convert the data into numeric values with filtering out missing values. Next, an intercept and an automatic number of lags are added to provide a more detailed output. Lastly, the output is structured for the stocks so that the test covers many different parameters as one can see after printing the code. In our case, it is sufficient to observe that the test statistic for every stock is less negative than the critical value at a five percent significance level, implying that the four time series are not stationary.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stationarity tests</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Stocks detailed ADF test</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#load package</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ADF test on closing prices</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>adf_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, name) {</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  close_prices <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">as.numeric</span>(<span class="fu">Cl</span>(x)))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(close_prices, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ADF test for"</span>, name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(test))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co">#ADF tests</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">adf_test</span>(AAPL,   <span class="st">"Apple"</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="fu">adf_test</span>(BNTX,   <span class="st">"BioNTech"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">adf_test</span>(<span class="st">`</span><span class="at">LHA.DE</span><span class="st">`</span>, <span class="st">"Lufthansa"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="fu">adf_test</span>(SHEL,   <span class="st">"Shell"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>A more simplified code yields the same solution: the null hypotheses cannot be rejected, and the time series are not stationary. The ADF test can be generated by transforming the data into a numeric form, removing all missing values while taking the pre-calculated closing prices into account. After repeating the procedure for every stock, it is evident that the p-value of all four stocks is higher than <code>0.05</code>, when considering a significance level of five percent.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#simplified ADF test stocks</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#load package</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#ADF tests</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(<span class="fu">as.numeric</span>(AAPL_cl)))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(<span class="fu">as.numeric</span>(BNTX_cl)))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(<span class="fu">as.numeric</span>(LHA_cl)))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(<span class="fu">as.numeric</span>(SHEL_cl)))</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#covid adf test</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#load package</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#ADF test</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(world<span class="sc">$</span>confirmed))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The next crucial step is to test whether the time series of our pandemic data, especially the confirmed cases, are stationary. While considering the simplified code for stocks, the code for the COVID data follows the same structure. Due to the confirmed cases being in a numeric format, only missing values must be removed before extracting the confirmed cases from the world table. As with the stocks, the p-value is not smaller than <code>0.05</code> indicating that the time series of confirmed cases is non-stationary.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#covid adf test</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#load package</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#ADF test</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(world<span class="sc">$</span>confirmed))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="time-series-become-stationary-mb" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="time-series-become-stationary-mb"><span class="header-section-number">3.5.2</span> Time Series Become Stationary (MB)</h3>
<p>Since the ADF test indicates that the time series of the stocks are non-stationary, we initially applied first differences. The code shows the daily price changes to achieve stationarity of the time series. This can be clearly seen from the plots that are produced. The values are removed from its trend and fluctuate around a stable mean, and dates with a higher volatility, crashes and booms, become visible. The plots support the previous statements from the analyses but do not add any additional value to further analysis. However, it illustrates the effect on the plot and the characteristics of stationary time series.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First differences</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#load packages</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to plot first differences of closing prices</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plot_first_diff_cl <span class="ot">&lt;-</span> <span class="cf">function</span>(cl, name) {</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Build a data frame with Date and Close values</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  df_diff <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Date  =</span> <span class="fu">as.Date</span>(<span class="fu">time</span>(cl)),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Close =</span> <span class="fu">as.numeric</span>(cl)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Restrict the sample period to 2019–2023</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"2019-01-01"</span>),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>           Date <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2023-12-31"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute first differences </span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Diff =</span> Close <span class="sc">-</span> <span class="fu">lag</span>(Close)) <span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove missing values </span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Diff))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the first differences over time</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df_diff, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Diff)) <span class="sc">+</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste</span>(name, <span class="st">"– First Differences"</span>),</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Daily price changes"</span>,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"First Difference"</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot first differences for each stock</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_first_diff_cl</span>(AAPL_cl, <span class="st">"Apple (AAPL)"</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_first_diff_cl</span>(BNTX_cl, <span class="st">"BioNTech (BNTX)"</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_first_diff_cl</span>(LHA_cl,  <span class="st">"Lufthansa (LHA.DE)"</span>)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_first_diff_cl</span>(SHEL_cl, <span class="st">"Shell (SHEL)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In contrast to our presentation, it turned out that there is a more suitable procedure, also regarding the following test, for achieving stationarity: log returns. These support later interpretation since log return can be added up and is commonly used. As with the comparison of all stocks in one plot, log returns include relative values rather than absolute values (<span class="citation" data-cites="FanYao2017">Fan and Yao (<a href="#ref-FanYao2017" role="doc-biblioref">2017</a>)</span>). This is a key difference due to having stocks with extreme price dynamics such as BioNTech.</p>
<p>Therefore, two codes to achieve stationarity for the stock’s closing prices as well as the confirmed COVID cases are provided.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log returns</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stocks</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to compute log returns and run an ADF test</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>get_log_returns <span class="ot">&lt;-</span> <span class="cf">function</span>(cl, name) {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute log returns from closing prices</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(<span class="fu">na.omit</span>(<span class="fu">as.numeric</span>(cl))))  <span class="co"># log returns</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run ADF test on log returns</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ADF Test for"</span>, name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">adf.test</span>(r))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return log return series</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  r</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute log returns for each stock</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>ret_AAPL <span class="ot">&lt;-</span> <span class="fu">get_log_returns</span>(AAPL_cl, <span class="st">"Apple (AAPL)"</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>ret_BNTX <span class="ot">&lt;-</span> <span class="fu">get_log_returns</span>(BNTX_cl, <span class="st">"BioNTech (BNTX)"</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>ret_LHA  <span class="ot">&lt;-</span> <span class="fu">get_log_returns</span>(LHA_cl,  <span class="st">"Lufthansa (LHA.DE)"</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>ret_SHEL <span class="ot">&lt;-</span> <span class="fu">get_log_returns</span>(SHEL_cl, <span class="st">"Shell (SHEL)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>With regard to the stocks, the previously created closing prices defined within a new function could also be used again for the code. To calculate the log returns, the closing prices must be again converted into a numeric format and removed of missing values. The returns are calculated by taking the difference of the log closing prices between two consecutive days, which highlights the expression as relative values. Next, the output after running the code is labeled and followed by an ADF test of the stocks previously recorded in r. Finally, the log returns for each stock can be calculated and stored with verification of stationarity of the ADF test. Due to all stocks’ <code>p-values</code> being below <code>0.05</code>, all four stocks and their time series can be treated as stationary.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covid log returns</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to compute a stationary COVID shock series and run an ADF test</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>get_covid_shock <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">name =</span> <span class="st">"COVID confirmed"</span>) {</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute log-growth differences using log1p to handle zero values</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log1p</span>(<span class="fu">na.omit</span>(x)))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run ADF test on the transformed COVID series</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ADF Test for"</span>, name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">adf.test</span>(r))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return COVID shock series</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  r</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute COVID shock series from global confirmed cases</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>covid_shock <span class="ot">&lt;-</span> <span class="fu">get_covid_shock</span>(world<span class="sc">$</span>confirmed, <span class="st">"COVID confirmed cases"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The code for the pandemic can nearly be used with the same structure as the stock code. However, there are three adjustments or changes required. First, the data is already in a numeric format. Second, log1p is included in the code assuming that there are days with zero cases. Lastly, the logarithm does not represent prices but rather the growth rate of confirmed cases, by the difference of log confirmed cases between two consecutive days. Ultimately, it can be stated that the <code>p-value</code> is below <code>0.05</code>, and the time series has no unit root anymore. This lays the basis for the Granger causality test.</p>
</section>
<section id="conducting-cranger-causality-test-mb" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="conducting-cranger-causality-test-mb"><span class="header-section-number">3.5.3</span> Conducting Cranger Causality Test (MB)</h3>
<p>The Granger causality test suits our two time series datasets and can be a next step regarding valuable information for our research question by combining these two. Moreover, it is an established method for analyzing our type of data and has existed for more than fifty years and was developed by Granger. The test is an addition to the forecasts and predictive analysis (<span class="citation" data-cites="ShojaieFox2022">Shojaie and Fox (<a href="#ref-ShojaieFox2022" role="doc-biblioref">2022</a>)</span>). Therefore, referring to Granger’s test, it can be said that “this characterization is clearly based on predictability and does not (directly) point to a causal effect of y on x: y improving the prediction of x does not mean y causes x” (<span class="citation" data-cites="ShojaieFox2022">Shojaie and Fox (<a href="#ref-ShojaieFox2022" role="doc-biblioref">2022</a>)</span>). Regarding volatility in this project, following Granger’s logic, one attempts to find out if covid_shock, as the variable y, Granger-causes the stocks return volatility, variable x. This becomes true when the confirmed cases enhance the prediction of the log return’s volatility. However, before explaining the analysis, a few limitations must be stated. The confirmed cases, for example, may be non-linear, which can have an effect on the Grangers output. For later interpretation, it is also important to be aware that the pandemic data is the only y variable although other variables, confounders, could also Granger-cause the return volatility (<span class="citation" data-cites="ShojaieFox2022">Shojaie and Fox (<a href="#ref-ShojaieFox2022" role="doc-biblioref">2022</a>)</span>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BioNTech Granger</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create BioNTech data frame with Date and LogReturn</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>ret_BNTX_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Date =</span> <span class="fu">as.Date</span>(zoo<span class="sc">::</span><span class="fu">index</span>(BNTX_cl))[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">LogReturn =</span> <span class="fu">as.numeric</span>(ret_BNTX)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute rolling volatility </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Volatility =</span> zoo<span class="sc">::</span><span class="fu">rollapply</span>(LogReturn, <span class="dv">21</span>, sd, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">align =</span> <span class="st">"right"</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># merge BioNTech volatility with COVID shock series by date</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>granger_vol_BNTX <span class="ot">&lt;-</span> ret_BNTX_df <span class="sc">%&gt;%</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, Volatility) <span class="sc">%&gt;%</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    world <span class="sc">%&gt;%</span> <span class="fu">select</span>(date, covid_shock),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Date"</span> <span class="ot">=</span> <span class="st">"date"</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove missing values and sort chronologically</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Date)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># run Granger causality test</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grangertest</span>(</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  Volatility <span class="sc">~</span> covid_shock,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="dv">5</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> granger_vol_BNTX</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now the Granger causality test can be applied with the same approach for every stock. The <code>log</code> returns of the stocks are converted into a data frame including the columns Date out of the closing prices where the first trading day is dropped to match the length of <code>LogReturn</code> with the calculated log returns. Next, the volatility is calculated and added to the data frame. This is done by the rolling standard deviation of the log return, considering a 21-trading day window. The Granger test can be prepared by concentrating just on Date and Volatility. The COVID data is then added by merging the stationary pandemic data with the volatility data based on the same date. In addition, missing values are removed, and the dataset is arranged in chronological order. The Granger causality test is then executed by a lag of five days, one trading week. As with the ADF test, the results are statistically significant if the results lay below the five percent significance level.</p>
<p>Considering a lag of five, the results vary. Lufthansa is the only stock where the <code>p-value</code> is above <code>0.05</code>, so there is no significant evidence that the <code>covid_shock</code> Granger-causes Lufthansa’s volatility. However, the other three stocks have p-values below the five percent significance level indicating statistically significant evidence that <code>covid_shock</code> Granger-causes the volatility of Apple, Shell and BioNTech. Moreover, in the case of BioNTech with the smallest <code>p-value</code>, far below <code>0.05</code>, it can be stated that the evidence for the Granger causality effect is the strongest. This implies that covid_shock enhances the prediction of the log return’s volatility of the three stocks. Ultimately, when considering the stocks as representative for their industry, COVID had an influence on the technology, energy and especially pharmaceutical sectors due to predicting their volatility evidently. However, no influence on the tourism sector’s stock volatility is observable, which could imply that other factors, so the confounders, are more significant. Especially the high significance of BioNTech highlights that different sectors were influenced differently by the pandemic. Lastly, one must nevertheless consider that COVID can be one driver of many others having an influence on the stock’s volatility.</p>
</section>
</section>
<section id="regression-analysis-ew" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="regression-analysis-ew"><span class="header-section-number">3.6</span> Regression Analysis (EW)</h2>
<p>Building on the previously conducted Granger causality test, which indicated that COVID shocks may be temporally related to stock volatility, linear regressions were then estimated. Volatility serves as the dependent variable and the COVID shock as the explanatory variable. The regressions are estimated separately for Lufthansa, Apple, BioNTech, and Shell using ordinary least squares (OLS). Here, all companies show a positive and statistically significant correlation between stock volatility and the COVID shock, with the strongest effect seen at BioNTech with an increase of <code>0.28</code>. This suggests that stronger pandemic-related shocks go hand in hand with higher market uncertainty (<span class="citation" data-cites="BakerEtAl2020">Baker et al. (<a href="#ref-BakerEtAl2020" role="doc-biblioref">2020</a>)</span>). However, as the robustness of these results still needs to be ensured, the Newey-West robust <code>standard error</code> was also used, which guarantees reliable statistical testing for time series data (<span class="citation" data-cites="NeweyWest1987">Newey and West (<a href="#ref-NeweyWest1987" role="doc-biblioref">1987</a>)</span>).</p>
<p>After applying this correction, the COVID coefficients lost their statistical significance in all models, although they remain positive. It can therefore be concluded that the significance observed in the OLS regressions is largely due to temporal dependencies in the data and that, without this correction, the influence of COVID shocks is overestimated by the regression.</p>
<p>Despite this, COVID had a significant impact on the uncertainty dynamics of the stock markets, but no stable, robust linear relationship between COVID shocks and stock volatility could be demonstrated, which is why the result should be viewed with caution (<span class="citation" data-cites="EngleGranger1987">Engle and Granger (<a href="#ref-EngleGranger1987" role="doc-biblioref">1987</a>)</span>).</p>
</section>
</section>
<section id="conclusion-ew.-lf-mb" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Conclusion (EW. LF, MB)</h1>
<p>The goal of this paper was to answer the following research question “To what extent do technology, tourism, pharmaceutical, and energy stocks differ in terms of their price volatility and recovery dynamics during and after the COVID-19 pandemic?”. Overall, during the COVID-19 pandemic it can be clearly stated that there are major differences between the four industries regarding price volatility and recovery dynamics. Either way, it can be marked that each stock has a crash of its stock prices at the start of the pandemic, indicating a potential influence of COVID, especially at the beginning of the pandemic, on the financial market.</p>
<p>This is especially evident in the technology sector (Apple), which initially suffered short-term at the beginning of the pandemic, but recovered quickly from 2020 to 2021. Additionally, a positive increase and strong long-term development followed. Based on our data, it can be said that COVID could have been an accelerating factor.</p>
<p>The tourism sector, which is represented by Lufthansa, ultimately experienced a strong negative impact during the pandemic and a long period of increased volatility. This was mainly due to the fact that people’s travelling and active lifestyles were restricted. Lufthansa’s shares have therefore never sustainably recovered as the stock prices were only situated a few times in the range where they were predicted based on pre-COVID data. BioNTech, which represents the pharmaceutical industry, shows a rather strong volatility. Accordingly, we were able to determine strong fluctuations. Early on, the BioNTech stock experienced a boom phase, likely due to the development of the vaccine, however, the peak was not sustained as the stock was significantly triggered by new events. As soon as the demand for the vaccine declined, the stock price fell.</p>
<p>The energy sector, which is represented by Shell, shows a sharp decline at the beginning of the pandemic, which suggests a demand shock. However, partial recoveries to the pre-COVID level were observed. Volatility remains relevant in this industry as well, as the economy also depends on macroeconomic factors. However, it cannot be ruled out that COVID was one of many other factors that influenced the stock or caused the stock performance. The same applies to all stocks. Starting with the regression analysis, it can be determined that COVID had a measurable impact on the dynamics of the stock market. However, a robust linear relationship between COVID and the stock market volatility could not be established, which means that the results should be interpreted with caution. Regarding the Granger causality tests, it can be said that COVID’s improved prediction is sector specific. The test results suggest that COVID shocks significantly improve the predictability of stock return volatility of Apple and Shell, as well as highlighting an immense significance with regard to BioNTech. This indicates that the pandemic had the most influence on the firm’s volatility, while no statistically significant Granger effect is found for Lufthansa.</p>
<p>In summary, the company BioNTech in the pharmaceutical sector has the highest volatility. Lufthansa showed the slowest and weakest recovery in the tourism sector, while Apple showed the best, most robust recovery in the technology sector. Overall, Shell was experiencing a mixed, partial recovery. In comparison, all four stocks performed differently, and COVID did not affect all industries equally.</p>
</section>
<section id="statement-ew-lf-mb" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Statement (EW, LF, MB)</h1>
<p>In the end, we can say that we made a lot of mistakes and cannot claim that this work was very easy for us. Right at the beginning, we had to discard our first research question due to a lack of sources. Then, unfortunately, we needed a lot of time trying to find a suitable topic that would provide enough data to enable us to carry out a thorough analysis.</p>
<p>There were also many delays due to our lack of coding knowledge. Unfortunately, our first dataset also failed due to a lack of data, and we had to discard it. Missing data due to holidays, but also different currencies, made our analysis very difficult. In addition, we were missing a large part of the data for BioNTech as the company only went public in October 2019.</p>
<p>When we were ready, we adjusted our raw dataset and then cleaned it. We converted the data into a long format, aggregated the provinces by country, and summed up the cumulative counts for all countries to obtain global cumulative daily values. We then worked with daily values for new infections, adjusted them retrospectively, and broke them down using logarithms to enable better visualization.</p>
<p>Our analysis, which we have described in detail in the paper, is also based on this data. However, we realized afterwards that this visualized data is not suitable for creating a clear awareness visualization result. We then attempted to calculate the number of newly confirmed cases per day using the seven-day average and logarithmic transformation. In addition, we did not reuse certain parts of the old code, such as the recovered values, because they were simply not relevant for further analysis. However, this does not mean that our analysis had any influence.</p>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-AryaSingh2025" class="csl-entry" role="listitem">
Arya, S., and S. Singh. 2025. <span>“The Role of Behavioral Finance in Understanding Market Anomalies.”</span> <em>SEEjph</em> 26 (1): 1799–1802.
</div>
<div id="ref-AthanasopoulosHyndman2021a" class="csl-entry" role="listitem">
Athanasopoulos, George, and Rob J. Hyndman. 2021a. <em>Forecasting: Principles and Practice</em>. <a href="https://otexts.com/fpp3/planning.html">https://otexts.com/fpp3/planning.html</a>.
</div>
<div id="ref-AthanasopoulosHyndman2021b" class="csl-entry" role="listitem">
———. 2021b. <em>Forecasting: Principles and Practice</em>. <a href="https://otexts.com/fpp3/arima.html">https://otexts.com/fpp3/arima.html</a>.
</div>
<div id="ref-BakerEtAl2020" class="csl-entry" role="listitem">
Baker, Scott R., Nicholas Bloom, Steven J. Davis, and Stephen J. Terry. 2020. <span>“COVID-Induced Economic Uncertainty.”</span> 26983. National Bureau of Economic Research. <a href="https://www.nber.org/papers/w26983">https://www.nber.org/papers/w26983</a>.
</div>
<div id="ref-BioNTechHistory2026" class="csl-entry" role="listitem">
BioNTech. 2026. <span>“Unsere Geschichte.”</span> 2026. <a href="https://www.biontech.com/de/de/home/about/history.html">https://www.biontech.com/de/de/home/about/history.html</a>.
</div>
<div id="ref-ReutersShell2021" class="csl-entry" role="listitem">
Bousso, Ron, and Saad Nasralla. 2021. <span>“Shell’s Profit Slumps in 2020 as the Pandemic Bites.”</span> 2021. <a href="https://www.reuters.com/article/business/shells-profit-slumps-in-2020-as-the-pandemic-bites-idUSKBN2A40RS/">https://www.reuters.com/article/business/shells-profit-slumps-in-2020-as-the-pandemic-bites-idUSKBN2A40RS/</a>.
</div>
<div id="ref-BuiEtAl2024" class="csl-entry" role="listitem">
Bui, K. H., Q. P. T. Thai, V. P. Nguyen, and N. A. D. Nguyen. 2024. <span>“A Review of Network Financial Recovery and Its Regulatory Applications in Financial Systematic Risk Regulations.”</span> <em>Cuadernos de Economía</em> 47: 106–8.
</div>
<div id="ref-BuijsEtAl2025" class="csl-entry" role="listitem">
Buijs, S. L., I. J. Sauer, C. M. Kropf, S. Juhel, Z. Stalhandske, and M. C. de Ruiter. 2025. <span>“Recovery Under Consecutive Disaster: How Recovery Dynamics Shape Societal Resilience.”</span> <em>EGUsphere Preprint Repository</em> 4: 1–3.
</div>
<div id="ref-DeutscheBoerse2023" class="csl-entry" role="listitem">
Deutsche Börse. 2023. <span>“Trading Calendar and Public Holidays.”</span> 2023. <a href="https://www.deutsche-boerse.com/dbg-de/produkt/kalendarische-feiertage-486962">https://www.deutsche-boerse.com/dbg-de/produkt/kalendarische-feiertage-486962</a>.
</div>
<div id="ref-Bundesbank2023" class="csl-entry" role="listitem">
Deutsche Bundesbank. 2023. <span>“Financial Stability Review 2023.”</span> Deutsche Bundesbank Eurosystem.
</div>
<div id="ref-DongDuGardner2020" class="csl-entry" role="listitem">
Dong, Ensheng, Hongru Du, and Lauren Gardner. 2020. <span>“An Interactive Web-Based Dashboard to Track COVID-19 in Real Time.”</span> <em>The Lancet Infectious Diseases</em> 20 (5): 533–34.
</div>
<div id="ref-EngleGranger1987" class="csl-entry" role="listitem">
Engle, Robert F., and Clive W. J. Granger. 1987. <span>“Co-Integration and Error Correction: Representation, Estimation, and Testing.”</span> <em>Econometrica</em> 55 (2): 251–76.
</div>
<div id="ref-ECB2023" class="csl-entry" role="listitem">
European Central Bank. 2023. <span>“Financial Stability Review.”</span> ECB Eurosystem.
</div>
<div id="ref-FanYao2017" class="csl-entry" role="listitem">
Fan, Jianqing, and Qiwei Yao. 2017. <span>“Asset Returns.”</span> <em>Cambridge</em> 2.
</div>
<div id="ref-Guagliano2018" class="csl-entry" role="listitem">
Guagliano, C. 2018. <span>“Monitoring Volatility in Financial Markets.”</span> ESMA.
</div>
<div id="ref-InvesteuropeBioNTech2026" class="csl-entry" role="listitem">
Invest Europe. 2026. <span>“Private Equity and Venture Capital Success Story BioNTech.”</span> 2026. <a href="https://www.investeurope.eu/about-private-equity/private-equity-and-venture-capital-success-stories/biontech/">https://www.investeurope.eu/about-private-equity/private-equity-and-venture-capital-success-stories/biontech/</a>.
</div>
<div id="ref-JHU2023" class="csl-entry" role="listitem">
Johns Hopkins University. 2023. <span>“COVID-19 Data Repository by the Center for Systems Science and Engineering (CSSE).”</span> 2023. <a href="https://github.com/CSSEGISandData/COVID-19">https://github.com/CSSEGISandData/COVID-19</a>.
</div>
<div id="ref-BritannicaApple2026" class="csl-entry" role="listitem">
Levy, Steven, and Kelly Montevirgen. 2026. <span>“Apple Company.”</span> 2026. <a href="https://www.britannica.com/money/Apple-Inc">https://www.britannica.com/money/Apple-Inc</a>.
</div>
<div id="ref-Li2017" class="csl-entry" role="listitem">
Li, B., J. Zhang, Y. He, and Y. Wang. 2017. <span>“Short-Term Load-Forecasting Method Based on Wavelet Decomposition with Second-Order Gray Neural Network Model Combined with ADF Test.”</span> <em>IEEE Access</em> 10: 16326.
</div>
<div id="ref-Li2024" class="csl-entry" role="listitem">
Li, J. 2024. <span>“Oil Industry Shell Company Business Strategy Analysis.”</span> <em>Advances in Economics, Business and Management Research</em>, 452–56.
</div>
<div id="ref-LiSun2023" class="csl-entry" role="listitem">
Li, M., and Y. Sun. 2023. <span>“An Overall Analysis of Apple Company.”</span> <em>BCP Business &amp; Management</em> 38: 2015–19.
</div>
<div id="ref-LufthansaGroup2026" class="csl-entry" role="listitem">
Lufthansa Group. 2026. <span>“Company.”</span> 2026. <a href="https://www.lufthansagroup.com/en/company.html">https://www.lufthansagroup.com/en/company.html</a>.
</div>
<div id="ref-MazurEtAl2021" class="csl-entry" role="listitem">
Mazur, M., M. Dang, and M. Vega. 2021. <span>“COVID-19 and the March 2020 Stock Market Crash: Evidence from s&amp;p 1500.”</span> <em>Finance Research Letters</em> 38: 1.
</div>
<div id="ref-NADAQBioNTech2019" class="csl-entry" role="listitem">
NASDAQ. 2019. <span>“BioNTech SE American Depositary Share (BNTX).”</span> 2019. <a href="https://www.nasdaq.com/market-activity/stocks/bntx">https://www.nasdaq.com/market-activity/stocks/bntx</a>.
</div>
<div id="ref-NaveedEtAl2024" class="csl-entry" role="listitem">
Naveed, N., K. Ahmad, H. Majeed, K. Qureshi, I. Ahmad, et al. 2024. <span>“The Global Impact of COVID-19: A Comprehensive Analysis of Its Effects on Various Aspects of Life.”</span> <em>Oxford</em> 13: 1–5.
</div>
<div id="ref-NeweyWest1987" class="csl-entry" role="listitem">
Newey, Whitney K., and Kenneth D. West. 1987. <span>“A Simple, Positive Semi-Definite, Heteroskedasticity and Autocorrelation Consistent Covariance Matrix.”</span> <em>Econometrica</em> 55 (3): 703–8.
</div>
<div id="ref-Nicolay2011" class="csl-entry" role="listitem">
Nicolay, D. 2011. <span>“Volatility Dynamics.”</span> <em>HAL Open Science</em>, 1–4.
</div>
<div id="ref-Noor2021" class="csl-entry" role="listitem">
Noor, R. 2021. <span>“Development Status of the Potential Vaccines for the Mitigation of the COVID-19 Pandemic.”</span> <em>Current Clinical Microbiology Reports</em> 8: 178–79.
</div>
<div id="ref-NYSE2023" class="csl-entry" role="listitem">
NYSE. 2023. <span>“NYSE Holiday Calendar.”</span> 2023. <a href="https://www.nyse.com/markets/hours-calendars">https://www.nyse.com/markets/hours-calendars</a>.
</div>
<div id="ref-PetricaEtAl2017" class="csl-entry" role="listitem">
Petrica, A. C., S. Stancu, and V. Ghitulescu. 2017. <span>“Stationarity: The Central Concept in Time Series Analysis.”</span> <em>International Journal of Emerging Research in Management and Technology</em> 6 (1): 7.
</div>
<div id="ref-Rustamov2024" class="csl-entry" role="listitem">
Rustamov, O. V. 2024. <span>“Understanding Volatility in Financial Markets.”</span> <em>International Journal of Innovative Technologies in Economy</em>, 1–4.
</div>
<div id="ref-RyanUlrich2023" class="csl-entry" role="listitem">
Ryan, Jeffrey A., and Joshua M. Ulrich. 2023. <em>Quantmod: Quantitative Financial Modelling Framework for r</em>.
</div>
<div id="ref-SchmidXia2024" class="csl-entry" role="listitem">
Schmid, Stefan, and Z. Xia. 2024. <span>“Lufthansa: A Century of International Growth.”</span> <em>ESCP Working Paper</em>, no. 72: 1–26.
</div>
<div id="ref-ShellStrategy2025" class="csl-entry" role="listitem">
Shell. 2025. <span>“Our Strategy.”</span> 2025. <a href="https://www.shell.com/what-we-do/our-strategy.html">https://www.shell.com/what-we-do/our-strategy.html</a>.
</div>
<div id="ref-ShiEtAl2020" class="csl-entry" role="listitem">
Shi, Y., G. Wang, X. Cai, J. Deng, L. Zheng, H. Zhu, and Z. Chen. 2020. <span>“An Overview of COVID-19.”</span> <em>Journal of Zhejiang University-Science</em> 21 (5): 343–46.
</div>
<div id="ref-ShojaieFox2022" class="csl-entry" role="listitem">
Shojaie, Ali, and Emily B. Fox. 2022. <span>“Granger Causality: A Review and Recent Advances.”</span> <em>Annual Review of Statistics and Its Application</em> 9: 291.
</div>
<div id="ref-SouzaEtAl2021" class="csl-entry" role="listitem">
Souza, A. S. R., M. M. R. Amorim, A. S. D. Q. Melo, et al. 2021. <span>“General Aspects of the COVID-19 Pandemic.”</span> <em>Northeast COVID-19 and Pregnancy Study Group</em> 21 (1): 30–33.
</div>
<div id="ref-WangCook2021" class="csl-entry" role="listitem">
Wang, E., and D. Cook. 2021. <span>“Conversations in Time: Interactive Visualization to Explore Structured Temporal Data.”</span> <em>Contributed Research Article</em>, 461.
</div>
<div id="ref-Wickham2016" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer.
</div>
<div id="ref-WickhamEtAl2019" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D. McGowan, et al. 2019. <span>“Welcome to the Tidyverse.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686.
</div>
<div id="ref-Wooldridge2020" class="csl-entry" role="listitem">
Wooldridge, Jeffrey M. 2020. <em>Introductory Econometrics: A Modern Approach</em>. 7th ed. Cengage.
</div>
<div id="ref-WHO2020" class="csl-entry" role="listitem">
World Health Organization. 2020. <span>“Estimating Mortality from COVID-19.”</span> 2020. <a href="https://www.who.int/news-room/commentaries/detail/estimating-mortality-from-covid-19">https://www.who.int/news-room/commentaries/detail/estimating-mortality-from-covid-19</a>.
</div>
<div id="ref-YahooApple2026" class="csl-entry" role="listitem">
Yahoo Finance. 2026a. <span>“Apple Inc. (AAPL).”</span> 2026. <a href="https://finance.yahoo.com/quote/AAPL/">https://finance.yahoo.com/quote/AAPL/</a>.
</div>
<div id="ref-YahooBioNTech2026" class="csl-entry" role="listitem">
———. 2026b. <span>“BioNTech SE (BNTX).”</span> 2026. <a href="https://finance.yahoo.com/quote/BNTX/">https://finance.yahoo.com/quote/BNTX/</a>.
</div>
<div id="ref-YahooLufthansa2026" class="csl-entry" role="listitem">
———. 2026c. <span>“Deutsche Lufthansa AG (LHA.DE).”</span> 2026. <a href="https://finance.yahoo.com/quote/LHA.F/">https://finance.yahoo.com/quote/LHA.F/</a>.
</div>
<div id="ref-YahooShell2026" class="csl-entry" role="listitem">
———. 2026d. <span>“Shell Plc (SHEL).”</span> 2026. <a href="https://finance.yahoo.com/quote/SHEL/">https://finance.yahoo.com/quote/SHEL/</a>.
</div>
<div id="ref-ZeileisGrothendieck2005" class="csl-entry" role="listitem">
Zeileis, Achim, and Gabor Grothendieck. 2005. <span>“Zoo: S3 Infrastructure for Regular and Irregular Time Series.”</span> <em>Journal of Statistical Software</em> 14 (6): 9–15.
</div>
</div>
</section>
<section id="affidavit" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Affidavit</h1>
<p>I hereby affirm that the submitted paper was authored independently, without the help of third parties, and without using any sources or aids other than those indi- cated. I have indicated all passages in the thesis that are taken from printed works or online sources, either in wording or in meaning, by citing the sources properly re- garding their origin and authorship. This paper, either in parts or in its entirety, be it in the same or similar form, has not been submitted to any other examination board and has not been published. I am aware that plagiarism is serious academic misconduct that will be reported to the examination board.</p>
<p>Cologne, 02.02.2025</p>
<p><img src="signature3.png" class="img-fluid" style="width:4cm"> <img src="signature1.png" class="img-fluid" style="width:4cm"> <img src="signature2.png" class="img-fluid" style="width:6cm"></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>